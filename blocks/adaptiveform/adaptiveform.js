function e(){e=function(){return t};var t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var o=Object.create((t&&t.prototype instanceof f?t:f).prototype),a=new E(i||[]);return r(o,"_invoke",{value:k(e,n,a)}),o}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d={};function f(){}function p(){}function v(){}var m={};l(m,a,function(){return this});var g=Object.getPrototypeOf,y=g&&g(g(S([])));y&&y!==n&&i.call(y,a)&&(m=y);var b=v.prototype=f.prototype=Object.create(m);function _(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function w(e,t){function n(r,o,a,s){var u=h(e[r],e,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?t.resolve(c.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):t.resolve(c).then(function(e){l.value=e,a(l)},function(e){return n("throw",e,a,s)})}s(u.arg)}var o;r(this,"_invoke",{value:function(e,i){function r(){return new t(function(t,r){n(e,i,t,r)})}return o=o?o.then(r,r):r()}})}function k(e,t,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=M(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=h(e,t,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}function M(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,M(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=h(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=v,r(b,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:p,configurable:!0}),p.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,l(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},_(w.prototype),l(w.prototype,s,function(){return this}),t.AsyncIterator=w,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new w(c(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(b),l(b,u,"Generator"),l(b,a,function(){return this}),l(b,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(this,arguments)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s=0;function u(e){return"__private_"+s+++"_"+e}function l(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var c=/*#__PURE__*/function(){function e(e,t){this.formContainer=void 0,this.element=void 0,this.active=void 0,this.id=void 0,this.parentView=void 0,this._model=void 0,this.options=void 0,this.formContainer=e.formContainer,this.id=e.id,this.element=e.element,this.element.id=e.id,this.active=!1,this.setModel(t)}var t=e.prototype;return t.setId=function(e){this.id=e},t.setParent=function(e){this.parentView=e,this.parentView.addChild&&this.parentView.addChild(this)},t.setActive=function(){this.isActive()||this.element.setAttribute("data-cmp-active","true"),this.parentView&&this.parentView.setActive&&this.parentView.setActive()},t.setInactive=function(){this.isActive()&&this.element.setAttribute("data-cmp-active","false"),this.parentView&&this.parentView.setInactive&&this.parentView.setInactive()},t.isActive=function(){return this.active},t.getFormContainerPath=function(){var e;return null==(e=this.options)?void 0:e.adaptiveformcontainerPath},t.getId=function(){return this.id},t.setModel=function(e){if(null!=this._model)throw"Re-initializing model is not permitted";this._model=e},t.toggle=function(e,t,n){this.toggleAttribute(this.element,e,t,n)},t.toggleAttribute=function(e,t,n,i){e&&(!1===t?e.setAttribute(n,i):e.removeAttribute(n))},t.getLayoutProperties=function(){var e={},t=this.getModel().getState();return t&&t.properties&&t.properties["afs:layout"]&&(e=t.properties["afs:layout"]),e},t.getModel=function(){return this._model},t.subscribe=function(){throw"the field does not subscribe to the model"},t.getState=function(){var e;return null==(e=this._model)?void 0:e.getState()},t.isVisible=function(){return(null==this?void 0:this.getState().visible)||!0},t.isEnabled=function(){return(null==this?void 0:this.getState().enabled)||!0},t.isLabelVisible=function(){var e,t;return(null==this||null==(e=this.getState())||null==(t=e.label)?void 0:t.visible)||!0},t.getLabelValue=function(){var e,t;return(null==this||null==(e=this.getState())||null==(t=e.label)?void 0:t.value)||""},t.getName=function(){var e;return(null==this||null==(e=this.getState())?void 0:e.name)||""},t.isTooltipVisible=function(){return!1},t.getTooltipValue=function(){return""},t.isShortDescVisible=function(){return!1},t.getShortDescValue=function(){return""},t.getDescriptionValue=function(){var e;return(null==this||null==(e=this.getState())?void 0:e.description)||""},t.getDefault=function(){var e;return(null==this||null==(e=this.getState())?void 0:e.default)||""},t.isReadOnly=function(){var e;return(null==this||null==(e=this.getState())?void 0:e.readOnly)||!1},t.isRequired=function(){var e;return(null==this||null==(e=this.getState())?void 0:e.required)||!1},t.getPlaceHolder=function(){var e;return(null==this||null==(e=this.getState())?void 0:e.placeholder)||""},t.getMinLength=function(){var e;return null==this||null==(e=this.getState())?void 0:e.minLength},t.getMaxLength=function(){var e;return null==this||null==(e=this.getState())?void 0:e.maxLength},t.getMinimum=function(){var e;return null==this||null==(e=this.getState())?void 0:e.minimum},t.getMaximum=function(){var e;return null==this||null==(e=this.getState())?void 0:e.maximum},e}();c.IS="FormField";var h=/*#__PURE__*/function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this).qm=void 0,i.widget=void 0,i.label=void 0,i.errorDiv=void 0,i.tooltip=void 0,i.description=void 0,i.element.className=i.getbemBlock(),i.widget=i.getWidget(),i.description=i.getDescription(),i.label=i.getLabel(),i.errorDiv=i.getErrorDiv(),i.qm=i.getQuestionMarkDiv(),i.tooltip=i.getTooltipDiv(),i}r(t,e);var n=t.prototype;return n.getWidget=function(){throw"method not implemented"},n.getDescription=function(){throw"method not implemented"},n.getLabel=function(){throw"method not implemented"},n.getErrorDiv=function(){throw"method not implemented"},n.getTooltipDiv=function(){throw"method not implemented"},n.getQuestionMarkDiv=function(){throw"method not implemented"},n.setModel=function(t){e.prototype.setModel.call(this,t);var n=this._model.getState();this._applyState(n)},n.setFocus=function(){var e;null==(e=this.getWidget())||e.focus()},n._applyState=function(e){e.value&&this._updateValue(e.value),this._updateVisible(e.visible),this._updateEnabled(e.enabled),this._initializeHelpContent(e)},n._initializeHelpContent=function(e){this._showHideLongDescriptionDiv(!1),this.getDescription()&&this._addHelpIconHandler(e)},n._showHideTooltipDiv=function(e){this.tooltip&&this.toggleAttribute(this.getTooltipDiv(),e,"data-cmp-visible",!1)},n._showHideLongDescriptionDiv=function(e){this.description&&this.toggleAttribute(this.description,e,"data-cmp-visible",!1)},n._isTooltipAlwaysVisible=function(){return!!this.getLayoutProperties().tooltipVisible},n._updateVisible=function(e){this.toggle(e,"aria-hidden",!0),this.element.setAttribute("data-cmp-visible",e+"")},n._updateEnabled=function(e){var t,n,i,r;this.getWidget()&&(this.toggle(e,"aria-disabled",!0),this.element.setAttribute("data-cmp-enabled",e+""),!1===e?(null==(t=this.getWidget())||t.setAttribute("disabled","true"),null==(n=this.getWidget())||n.setAttribute("aria-disabled","true")):(null==(i=this.getWidget())||i.removeAttribute("disabled"),null==(r=this.getWidget())||r.removeAttribute("aria-disabled")))},n._updateValid=function(e,t){this.errorDiv&&(this.toggle(e,"aria-invalid",!0),this.element.setAttribute("data-cmp-valid",e+""),("string"!=typeof t.errorMessage||""===t.errorMessage)&&(this.errorDiv.innerHTML=!0===e?"":"There is an error in the field"))},n._updateErrorMessage=function(e,t){this.errorDiv&&(this.errorDiv.innerHTML=t.errorMessage)},n._updateValue=function(e){var t=this.getWidget();t&&(t.value=e)},n._addHelpIconHandler=function(e){var t=this.qm,n=this.description,i=this._isTooltipAlwaysVisible(),r=this;t&&n&&t.addEventListener("click",function(e){e.preventDefault(),"false"===n.getAttribute("data-cmp-visible")?(r._showHideLongDescriptionDiv(!0),i&&r._showHideTooltipDiv(!1)):(r._showHideLongDescriptionDiv(!1),i&&r._showHideTooltipDiv(!0))})},n.getClass=function(){return this.constructor.IS},n.subscribe=function(){var e=this;this._model.subscribe(function(t){var n=t.target.getState();t.payload.changes.forEach(function(t){var i,r="_update"+((i=t.propertyName)[0].toUpperCase()+i.slice(1));"function"==typeof e[r]?"items"===t.propertyName?e[r](t.prevValue,t.currentValue,n):e[r](t.currentValue,n):console.error("changes to "+t.propertyName+" are not supported. Please raise an issue")})})},n.getbemBlock=function(){throw"bemBlock not implemented"},n.getIS=function(){throw"IS is not implemented"},n.addListener=function(){},n.render=function(){this.element.innerHTML=this.getHTML(),this.addListener(),this.subscribe()},n.getHTML=function(){return'\n            <div class="'+this.getbemBlock()+'"\n                data-cmp-is="'+this.getIS()+'"\n                id="'+this.id+'"\n                data-cmp-visible="'+this.isVisible()+'"\n                data-cmp-enabled="'+this.isEnabled()+'"\n                data-cmp-adaptiveformcontainer-path="'+this.getFormContainerPath()+'">\n\n                '+this.renderLabel()+"\n                "+this.getInputHTML()+"\n                "+this.getQuestionMarkHTML()+"\n                "+this.getShortDescHTML()+"\n                "+this.getLongDescHTML()+"\n                "+this.getErrorHTML()+"\n            </div>"},n.getInputHTML=function(){throw"getInputHTML is not implemented"},n.renderLabel=function(){return this.isLabelVisible()?'<label id="'+this.id+'-label" for="'+this.id+'" class="'+this.getbemBlock()+'__label" >'+this.getLabelValue()+"</label>":""},n.getQuestionMarkHTML=function(){return this.getDescriptionValue()?'<button class="'+this.getbemBlock()+'__questionmark" data-sly-test="'+this.getDescriptionValue()+'">\n        </button>':""},n.getShortDescHTML=function(){return this.isShortDescVisible()?'<div id="'+this.id+'-shortDescription" class="'+this.getbemBlock()+'__shortdescription">\n                {this.getShortDescValue()}\n            </div>':""},n.getLongDescHTML=function(){return'<div aria-live="polite">\n                '+(this.getDescriptionValue()?'<div id="'+this.id+'-longDescription" class="'+this.getbemBlock()+'__longdescription"></div>':"")+"\n            </div>"},n.getErrorHTML=function(){return'<div id="'+this.id+'-errorMessage" class="'+this.getbemBlock()+'__errormessage"></div>'},n.getDisabledHTML=function(){return this.isEnabled()?"":' disabled="true" '},n.getReadonlyHTML=function(){return this.isReadOnly()?' readonly="true" ':""},t}(c),d=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.getWidget=function(){return this.element.querySelector(t.selectors.widget)},n.getDescription=function(){return this.element.querySelector(t.selectors.description)},n.getLabel=function(){return this.element.querySelector(t.selectors.label)},n.getErrorDiv=function(){return this.element.querySelector(t.selectors.errorDiv)},n.getTooltipDiv=function(){return this.element.querySelector(t.selectors.tooltipDiv)},n.getQuestionMarkDiv=function(){return this.element.querySelector(t.selectors.qm)},n.addListener=function(){var e,t,n=this;null==(e=this.getWidget())||e.addEventListener("blur",function(e){n._model.value=e.target.value,n.setInactive()}),null==(t=this.getWidget())||t.addEventListener("focus",function(e){n.setActive()})},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getInputHTML=function(){return'<input\n            class="cmp-adaptiveform-textinput__widget"\n            title="'+(this.isTooltipVisible()?this.getTooltipValue():"")+'"\n            aria-label="'+(this.isLabelVisible()?this.getLabelValue():"")+'"\n            type="text"\n            name="'+this.getName()+'"\n            value="'+this.getDefault()+'"\n            '+this.getDisabledHTML()+"\n            "+this.getReadonlyHTML()+'\n            required="'+this.isRequired()+'"\n            placeholder="'+this.getPlaceHolder()+'"\n            minlength="'+this.getMinLength()+'"\n            maxlength="'+this.getMaxLength()+'"/>'},t}(h);function f(e){var t={exports:{}};return e(t,t.exports),t.exports}d.NS="cmp",d.IS="adaptiveFormTextInput",d.bemBlock="cmp-adaptiveform-textinput",d.selectors={self:"[data-"+d.NS+'-is="'+d.IS+'"]',widget:"."+d.bemBlock+"__widget",label:"."+d.bemBlock+"__label",description:"."+d.bemBlock+"__longdescription",qm:"."+d.bemBlock+"__questionmark",errorDiv:"."+d.bemBlock+"__errormessage",tooltipDiv:"."+d.bemBlock+"__shortdescription"};var p=y;const v=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvV]{1,5}|[zZOvVxX]{1,3}|S{1,3}|'(?:[^']|'')*')|[^a-zA-Z']+/g;function m(e,t){const n={},i=e.split(/\s/).filter(e=>e.length);n.dateStyle=i[0],i.length>1&&(n.timeStyle=i[1]);const r=new Date(2e3,2,1,2,3,4),o=new Intl.DateTimeFormat(t,n).formatToParts(r),a=o.find(e=>"month"===e.type).value,s=new Intl.DateTimeFormat(t,{month:"long"}).formatToParts(r)[0].value,u=new Intl.DateTimeFormat(t,{month:"short"}).formatToParts(r)[0].value,l=[];return o.forEach(t=>{let n,{type:i,value:r}=t;"month"===i&&(n={[a]:"medium"===e?"short":"long",[s]:"long",[u]:"short","03":"2-digit",3:"numeric"}[r]),"year"===i&&(n={2e3:"numeric","00":"2-digit"}[r]),["day","hour","minute","second"].includes(i)&&(n=2===r.length?"2-digit":"numeric"),"literal"===i&&(n=r),"dayPeriod"===i&&(n="short"),l.push([i,n,r.length])}),l}var g=/*#__PURE__*/Object.defineProperty({getSkeleton:function(e,t){if(p.ShorthandStyles.find(t=>e.includes(t))){const n=m(e,t),i=[],r={month:"M",year:"Y",day:"d"};return n.forEach(e=>{let[t,n,o]=e;t in r?i.push(Array(o).fill(r[t]).join("")):"literal"===t&&i.push(n)}),i.join("")}return e},parseDateTimeSkeleton:function(e,t){if(p.ShorthandStyles.find(t=>e.includes(t)))return m(e,t);const n=[];return e.replace(v,e=>{const t=e.length;switch(e[0]){case"G":n.push(["era",4===t?"long":5===t?"narrow":"short",t]);break;case"y":n.push(["year",2===t?"2-digit":"numeric",t]);break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":n.push(["month",["numeric","2-digit","short","long","narrow"][t-1],t]);break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":n.push(["day",["numeric","2-digit"][t-1],t]);break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":n.push(["weekday",["short","short","short","long","narrow","narrow"][t-1],t]);break;case"e":if(t<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");n.push(["weekday",["short","long","narrow","short"][t-4],t]);break;case"c":if(t<3||t>5)throw new RangeError("`c, cc, cccccc` (weekday) patterns are not supported");n.push(["weekday",["short","long","narrow","short"][t-3],t]);break;case"a":n.push(["hour12",!0,1]);break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":n.push(["hourCycle","h12"]),n.push(["hour",["numeric","2-digit"][t-1],t]);break;case"H":n.push(["hourCycle","h23",1]),n.push(["hour",["numeric","2-digit"][t-1],t]);break;case"K":n.push(["hourCycle","h11",1]),n.push(["hour",["numeric","2-digit"][t-1],t]);break;case"k":n.push(["hourCycle","h24",1]),n.push(["hour",["numeric","2-digit"][t-1],t]);break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":n.push(["minute",["numeric","2-digit"][t-1],t]);break;case"s":n.push(["second",["numeric","2-digit"][t-1],t]);break;case"S":n.push(["fractionalSecondDigits",t,t]);break;case"A":throw new RangeError("`S/A` (millisecond) patterns are not supported, use `s` instead");case"O":n.push(["timeZoneName",t<4?"shortOffset":"longOffset",t]),n.push(["x-timeZoneName",t<4?"O":"OOOO",t]);break;case"X":case"x":case"Z":n.push(["timeZoneName","longOffset",1]),n.push(["x-timeZoneName",e,1]);break;case"z":case"v":case"V":throw new RangeError("z/v/V` (timeZone) patterns are not supported, use `X/x/Z/O` instead");case"'":n.push(["literal",e.slice(1,-1).replace(/''/g,"'"),-1]);break;default:n.push(["literal",e,-1])}return""}),n}},"__esModule",{value:!0}),y=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ShorthandStyles=void 0,t.adjustTimeZone=l,t.datetimeToNumber=function(e){return null===e?0:e.getTime()/864e5},t.formatDate=function(e,t,n,i){if(c.find(e=>n.includes(e))){const r={timeZone:i},o=n.split(/\s/).filter(e=>e.length);return c.indexOf(o[0])>-1&&(r.dateStyle=o[0]),o.length>1&&c.indexOf(o[1])>-1&&(r.timeStyle=o[1]),new Intl.DateTimeFormat(t,r).format(e)}return function(e,t,n,i){const r=(0,g.parseDateTimeSkeleton)(n,t);r.push(["timeZone",i]);const o=r.filter(e=>!e[0].startsWith("x-")),a=r.filter(e=>e[0].startsWith("x-")),s=Object.fromEntries(o);delete s.literal;const u=new Intl.DateTimeFormat(t,s).formatToParts(e);return function(e,t){["hour","minute","second"].forEach(n=>{const i=e.find(e=>e.type===n);if(!i)return;const r=t.find(e=>e[0]===n)[1];"2-digit"===r&&1===i.value.length&&(i.value=`0${i.value}`),"numeric"===r&&2===i.value.length&&"0"===i.value.charAt(0)&&(i.value=i.value.slice(1))})}(u,r),function(e,t){const n=e.find(e=>"year"===e.type);if(!n)return;const i=t.find(e=>"year"===e[0])[2];for(;n.value.length<i;)n.value=`0${n.value}`}(u,o),o.reduce((e,t)=>{if("literal"===t[0])e.push(t);else{const n=u.find(e=>{return e.type===({hour12:"dayPeriod",fractionalSecondDigits:"fractionalSecond"}[n=t[0]]||n);var n});if(n&&"timeZoneName"===n.type){const e=a.find(e=>"x-timeZoneName"===e[0])[1],t=e[0];"Z"===t&&(e.length<4?(n.value=n.value.replace(/(GMT|:)/g,""),""===n.value&&(n.value="+0000")):5===e.length&&(n.value="GMT"===n.value?"Z":n.value.replace(/GMT/,""))),"X"===t||"x"===t?(1===e.length&&(n.value=n.value.replace(/(GMT|:(00)?)/g,"")),2===e.length&&(n.value=n.value.replace(/(GMT|:)/g,"")),3===e.length&&(n.value=n.value.replace(/GMT/g,"")),"X"===t&&""===n.value&&(n.value="Z")):"O"===e&&(n.value=n.value.replace(/GMT/g,"").replace(/0(\d+):/,"$1:").replace(/:00/,""),""===n.value&&(n.value="+0"))}n&&e.push([n.type,n.value])}return e},[])}(e,t,n,i).map(e=>e[1]).join("")},t.numberToDatetime=function(e){return new Date(Math.round(1e3*e*60*60*24))},t.offsetMS=s,t.offsetMSFallback=u,t.parseDate=h,t.parseDefaultDate=function(e,t,n){return h(e,t,"short",null,!1)};const n=[0,1,2,3,4,5,6,7,8,9,10,11].map(e=>new Date(2e3,e,1));function i(e,t){return n.map(n=>{const i=new Intl.DateTimeFormat(e,t).formatToParts(n).find(e=>"month"===e.type);return i&&i.value})}function r(e){return new Intl.NumberFormat(e,{style:"decimal",useGrouping:!1}).format(9876543210).split("").reverse()}function o(e){var t;return"هـ"===(null===(t=new Intl.DateTimeFormat(e,{era:"short"}).formatToParts(new Date).find(e=>"era"===e.type))||void 0===t?void 0:t.value)?"islamic":"gregory"}function a(e){const t=new Date(2e3,1,1,1,1,1),n=new Date(2e3,1,1,16,1,1),i=new Intl.DateTimeFormat(e,{dateStyle:"full",timeStyle:"full"}),r=i.formatToParts(t).find(e=>"dayPeriod"===e.type),o=i.formatToParts(n).find(e=>"dayPeriod"===e.type);return r&&o?{regex:`(${r.value}|${o.value})`,fn:(e,t)=>t.hour+=e===o.value?12:0}:null}function s(e,t){let n;try{n=new Intl.DateTimeFormat("en-US",{timeZone:t,timeZoneName:"longOffset"}).format(e)}catch(e){return u(0,t)}const i=/GMT([+\-−])?(\d{1,2}):?(\d{0,2})?/.exec(n);if(!i)return 0;const[r,o,a]=i.slice(1),s=60*(60*(isNaN(parseInt(o))?0:parseInt(o))+(isNaN(parseInt(a))?0:parseInt(a)))*1e3;return"-"===r?-s:s}function u(e,t){const n=function(e){var t=new Date;function n(e){var t=e.replace(":"," ").split(" ");return{day:parseInt(t[0]),hour:parseInt(t[1]),minute:parseInt(t[2])}}var i=t.toLocaleString("en-US",{timeZone:e,day:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),r=n(i),o=n(i=t.toLocaleString("en-US",{day:"numeric",hour:"numeric",minute:"numeric",hour12:!1}));return 24*r.day*60+60*r.hour+r.minute-(24*o.day*60+60*o.hour+o.minute)-t.getTimezoneOffset()}(t);return 60*n*1e3}function l(e,t){if(null===e)return null;let n=e.getTime()-60*e.getTimezoneOffset()*1e3;const i=s(e,t);return u(0,t),n+=-i,new Date(n)}const c=["full","long","medium","short"];function h(e,t,n,s){let u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const c=[],h=[],d=o(t),f=r(t),p=`([${f[0]}-${f[9]}]{1,2})`,v=`([${f[0]}-${f[9]}]{1,3})`,m=`([${f[0]}-${f[9]}]{1,4})`;let y="h12",b=u,_=!1;const w=e=>1===e.length&&":-/.".includes(e),k=e=>M(e)-1,M=e=>e.split("").reduce((e,t)=>10*e+f.indexOf(t),0),j=e=>t=>{let n=M(t);return n=n<100&&2===e?n+2e3:n,"islamic"===d&&(n=Math.ceil(.97*n+622)),e>2&&n<100&&(_=!0),n},D=e=>t=>e.indexOf(t),E=(0,g.parseDateTimeSkeleton)(n,t),S=i(t,Object.fromEntries(E));E.forEach(e=>{let[n,i,r]=e;if("literal"===n)w(i)?h.push(`[^${f[0]}-${f[9]}]`):h.push(i);else if("month"===n&&["numeric","2-digit"].includes(i))h.push(p),c.push(["month",k]);else if("month"===n&&["formatted","long","short","narrow"].includes(i))h.push(`(${S.join("|")})`),c.push(["month",D(S)]);else if(["day","minute","second"].includes(n))"minute"!==n&&"second"!==n||(b=!1),h.push(p),c.push([n,M]);else if("fractionalSecondDigits"===n)b=!1,h.push(v),c.push([n,(e,t)=>t.fractionalSecondDigits+M(e)]);else if("hour"===n)b=!1,h.push(p),c.push([n,(e,t)=>t.hour+M(e)]);else if("year"===n)h.push("numeric"===i?m:p),c.push(["year",j(r)]);else if("dayPeriod"===n){b=!1;const e=a(t);e&&(h.push(e.regex),c.push(["hour",e.fn]))}else"hourCycle"===n?(b=!1,y=i):"x-timeZoneName"===n?(b=!1,h.push("(?:GMT|UTC|Z)?([+\\-−0-9]{0,3}:?[0-9]{0,2})"),c.push([n,(e,t)=>{if(b=!0,!e)return;const n=e.replace(/−/,"-").match(/([+\-\d]{2,3}):?(\d{0,2})/),i=1*n[1];t.hour-=i;const r=n.length>2?1*n[2]:0;t.minute-=i<0?-r:r}])):"timeZoneName"!==n&&(b=!1,h.push(".+?"));return h},[]);const x=new RegExp(h.join("")),T=e.match(x);if(null===T)return e;const O={year:1972,month:0,day:1,hour:0,minute:0,second:0,fractionalSecondDigits:0};if(T.slice(1).forEach((e,t)=>{const[n,i]=c[t];O[n]=i(e,O)}),"h24"===y&&24===O.hour&&(O.hour=0),"h12"===y&&12===O.hour&&(O.hour=0),b){const e=new Date(Date.UTC(O.year,O.month,O.day,O.hour,O.minute,O.second,O.fractionalSecondDigits));return _&&e.setUTCFullYear(O.year),e}const L=new Date(O.year,O.month,O.day,O.hour,O.minute,O.second,O.fractionalSecondDigits);return _&&L.setFullYear(O.year),null==s?L:l(L,s)}t.ShorthandStyles=c}),b=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"formatDate",{enumerable:!0,get:function(){return p.formatDate}}),Object.defineProperty(t,"getSkeleton",{enumerable:!0,get:function(){return g.getSkeleton}}),Object.defineProperty(t,"parseDate",{enumerable:!0,get:function(){return p.parseDate}})}),_=f(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"formatDate",{enumerable:!0,get:function(){return b.formatDate}}),Object.defineProperty(t,"getSkeleton",{enumerable:!0,get:function(){return b.getSkeleton}}),Object.defineProperty(t,"parseDate",{enumerable:!0,get:function(){return b.parseDate}})});function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},w.apply(this,arguments)}var k=function(e){try{var t=e.name,n=e.size,i=e.type;return Promise.resolve(new Promise(function(r,o){var a=new FileReader;a.onload=function(e){r(new ge({data:Ae(e.target.result,t),type:i,name:t,size:n}))},a.readAsDataURL(e.data)}))}catch(e){return Promise.reject(e)}},M=function(e,t){void 0===e&&(e=""),void 0===t&&(t=[]),this.errorMessages=t,this.fieldName=e},j=function(e){return new Map(Object.entries(e))},D=j({date:"date-input","data-url":"file-input",binary:"file-input"}),E=j({number:"number-input",boolean:"checkbox",object:"panel",array:"panel",file:"file-input","file[]":"file-input"}),S=["string[]","boolean[]","number[]","array"],x=function(e){var t=e.type||"string";return"enum"in e?e.enum.length>2||S.indexOf(t)>-1?"drop-down":"checkbox":"string"===t||"string[]"===t?D.get(e.format)||"text-input":E.get(t)||"text-input"},T=function(e){return"file"===(null==e?void 0:e.type)||"file[]"===(null==e?void 0:e.type)||("string"===(null==e?void 0:e.type)||"string[]"===(null==e?void 0:e.type))&&("binary"===(null==e?void 0:e.format)||"data-url"===(null==e?void 0:e.format))};function O(e,t){var n;return e instanceof Array?(n=[],n=e.map(function(e){return O(e,t)})):"object"==typeof e&&null!==e?(n={},Object.entries(e).forEach(function(e){n[e[0]]=O(e[1],t)})):n=e,t&&n&&n.id&&(n.id=t()),n}var L=function(e){return JSON.stringify(e,null,2)},P=/*#__PURE__*/function(){function e(e,t,n){this._metadata=n,this._payload=e,this._type=t}var t=e.prototype;return t.payloadToJson=function(){return this.payload},t.toJson=function(){return{payload:this.payloadToJson(),type:this.type,isCustomEvent:this.isCustomEvent}},t.toString=function(){return JSON.stringify(this.toJson())},n(e,[{key:"type",get:function(){return this._type}},{key:"payload",get:function(){return this._payload}},{key:"metadata",get:function(){return this._metadata}},{key:"target",get:function(){return this._target}},{key:"isCustomEvent",get:function(){return!1}}]),e}(),N=/*#__PURE__*/function(e){function t(t,n){return void 0===n&&(n=!1),e.call(this,t,"change",{dispatch:n})||this}return r(t,e),t.prototype.withAdditionalChange=function(e){return new t(this.payload.changes.concat(e.payload.changes),this.metadata)},t}(P),I=/*#__PURE__*/function(e){function t(t){return void 0===t&&(t={}),e.call(this,t,"invalid",{})||this}return r(t,e),t}(P),C=/*#__PURE__*/function(e){function t(t){return void 0===t&&(t={}),e.call(this,t,"valid",{})||this}return r(t,e),t}(P),q=/*#__PURE__*/function(e){function t(t,n){return void 0===t&&(t={}),void 0===n&&(n=!1),e.call(this,t,"executeRule",{dispatch:n})||this}return r(t,e),t}(P),V=function(e,t,n){return new N({changes:[{propertyName:e,currentValue:t,prevValue:n}]})},$=/*#__PURE__*/function(e){function t(t,n){return void 0===n&&(n=!1),e.call(this,t,"initialize",{dispatch:n})||this}return r(t,e),t}(P),A=/*#__PURE__*/function(e){function t(){return e.call(this,{},"load",{dispatch:!1})||this}return r(t,e),t}(P),F=/*#__PURE__*/function(e){function t(t,n){return void 0===n&&(n=!1),e.call(this,t,"click",{dispatch:n})||this}return r(t,e),t}(P),R=/*#__PURE__*/function(e){function t(t,n){return void 0===n&&(n=!1),e.call(this,t,"blur",{dispatch:n})||this}return r(t,e),t}(P),B=/*#__PURE__*/function(e){function t(t,n){return void 0===n&&(n=!1),e.call(this,t,"validationComplete",{dispatch:n})||this}return r(t,e),t}(P),H=/*#__PURE__*/function(e){function t(t,n){return void 0===n&&(n=!1),e.call(this,t,"submit",{dispatch:n})||this}return r(t,e),t}(P),z=/*#__PURE__*/function(e){function t(t,n){return e.call(this,{field:n,changes:t},"fieldChanged")||this}return r(t,e),t}(P),W=/*#__PURE__*/function(e){function t(t,n,i){return void 0===n&&(n={}),void 0===i&&(i=!1),e.call(this,n,t,{dispatch:i})||this}return r(t,e),n(t,[{key:"isCustomEvent",get:function(){return!0}}]),t}(P),U=/*#__PURE__*/function(e){function t(t){return e.call(this,t,"addItem")||this}return r(t,e),t}(P),Q=/*#__PURE__*/function(e){function t(t){return e.call(this,t,"removeItem")||this}return r(t,e),t}(P),G=/*#__PURE__*/function(){function e(e,t,n){void 0===n&&(n=typeof t),this.$_fields=[],this.$_name=e,this.$_value=t,this.$_type=n}var t=e.prototype;return t.valueOf=function(){return this.$_value},t.setValue=function(e,t,n){this.$_value=e,this.$_fields.forEach(function(e){n!==e&&(e.value=t)})},t.$bindToField=function(e){-1===this.$_fields.indexOf(e)&&this.$_fields.push(e)},t.$convertToDataValue=function(){return this},n(e,[{key:"$name",get:function(){return this.$_name}},{key:"$value",get:function(){return this.$_value}},{key:"$type",get:function(){return this.$_type}},{key:"$isDataGroup",get:function(){return!1}}]),e}(),Z=Symbol("NullValue"),J=new(/*#__PURE__*/function(e){function t(){return e.call(this,"",Z,"null")||this}r(t,e);var n=t.prototype;return n.setValue=function(){},n.$bindToField=function(){},n.$length=function(){return 0},n.$convertToDataValue=function(){return this},n.$addDataNode=function(){},n.$removeDataNode=function(){},n.$getDataNode=function(){return this},n.$containsDataNode=function(){return!1},t}(G)),K=/*#__PURE__*/function(e){r(i,e);var t=i.prototype;function i(t,n,i){var r;return void 0===i&&(i=typeof n),(r=e.call(this,t,n,i)||this).$_items=n instanceof Array?n.map(function(e,t){return r.createEntry(t,e)}):Object.fromEntries(Object.entries(n).map(function(e){var t=e[0];return[t,r.createEntry(t,e[1])]})),r}return t.createEntry=function(e,t){var n=t instanceof Array?"array":typeof t;return"object"==typeof t&&null!=t?new i(e,t,n):new G(e,t,n)},t.$convertToDataValue=function(){return new G(this.$name,this.$value,this.$type)},t.$addDataNode=function(e,t,n){if(void 0===n&&(n=!1),t!==J)if("array"===this.$type){var i=e;n?this.$_items[e]=t:this.$_items.splice(i,0,t)}else this.$_items[e]=t},t.$removeDataNode=function(e){this.$_items[e]=void 0},t.$getDataNode=function(e){if(this.$_items.hasOwnProperty(e))return this.$_items[e]},t.$containsDataNode=function(e){return this.$_items.hasOwnProperty(e)&&void 0!==this.$_items[e]},n(i,[{key:"$value",get:function(){return"array"===this.$type?Object.values(this.$_items).filter(function(e){return void 0!==e}).map(function(e){return e.$value}):Object.fromEntries(Object.values(this.$_items).filter(function(e){return void 0!==e}).map(function(e){return[e.$name,e.$value]}))}},{key:"$length",get:function(){return Object.entries(this.$_items).length}},{key:"$isDataGroup",get:function(){return!0}}]),i}(G),Y=function(e,t){return{type:"Identifier",value:e,start:t}},X=function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"_"===e},ee=function(e,t,n){return null===e&&"$"===t[n]},te=function(e,t){var n=e[t];return"$"===n?e.length>t&&X(e[t+1]):n>="a"&&n<="z"||n>="A"&&n<="Z"||"_"===n},ne=function(e){return e>="0"&&e<="9"},ie=/*#__PURE__*/function(){function e(e){this._tokens=[],this._result_tokens=[],this.stream=e,this._current=0}var t=e.prototype;return t._consumeGlobal=function(){return this._current+=1,{type:"Global",start:0,value:"$"}},t._consumeUnquotedIdentifier=function(e){var t=this._current;for(this._current+=1;this._current<e.length&&X(e[this._current]);)this._current+=1;return Y(e.slice(t,this._current),t)},t._consumeQuotedIdentifier=function(e){var t=this._current;this._current+=1;for(var n=e.length;'"'!==e[this._current]&&this._current<n;){var i=this._current;this._current=i+="\\"!==e[i]||"\\"!==e[i+1]&&'"'!==e[i+1]?1:2}return this._current+=1,Y(JSON.parse(e.slice(t,this._current)),t)},t._consumeNumber=function(e){var t=this._current;this._current+=1;for(var n=e.length;ne(e[this._current])&&this._current<n;)this._current+=1;var i=e.slice(t,this._current);return{type:"Number",value:parseInt(i,10),start:t}},t._consumeBracket=function(e){var t,n=this._current;if(this._current+=1,!ne(e[this._current]))throw new Error("unexpected exception at position "+this._current+". Must be a character");if(t=this._consumeNumber(e).value,this._current<this.stream.length&&"]"!==e[this._current])throw new Error("unexpected exception at position "+this._current+". Must be a character");return this._current++,function(e,t){return{type:"bracket",value:e,start:t}}(t,n)},t.tokenize=function(){for(var e=this.stream;this._current<e.length;){var t=this._tokens.length?this._tokens.slice(-1)[0]:null;if(ee(t,e,this._current)){var n=this._consumeGlobal();this._tokens.push(n),this._result_tokens.push(n)}else if(te(e,this._current)){var i=this._consumeUnquotedIdentifier(e);this._tokens.push(i),this._result_tokens.push(i)}else if("."===e[this._current]&&null!=t&&"DOT"!==t.type)this._tokens.push({type:"DOT",value:".",start:this._current}),this._current+=1;else if("["===e[this._current]){var r=this._consumeBracket(e);this._tokens.push(r),this._result_tokens.push(r)}else{if('"'!==e[this._current]){var o=Math.max(0,this._current-2),a=Math.min(this.stream.length,this._current+2);throw new Error("Exception at parsing stream "+this.stream.slice(o,a))}var s=this._consumeQuotedIdentifier(e);this._tokens.push(s),this._result_tokens.push(s)}}return this._result_tokens},e}(),re=function(e){return new ie(e).tokenize()},oe=function(e,t,n){var i;i="string"==typeof t?re(t):t;for(var r=e,o=0,a=function(e,t,n){return null===t?n:"bracket"===t.type?new K(e.value,[],"array"):new K(e.value,{})};o<i.length&&null!=r;){var s=i[o];if("Global"===s.type)r=e;else if("Identifier"===s.type){if(!(r instanceof K&&"object"===r.$type))throw new Error("Looking for "+s.value+" in "+r.$value);if(r.$containsDataNode(s.value)&&null!==r.$getDataNode(s.value).$value)r=r.$getDataNode(s.value);else if(n){var u=a(s,o<i.length-1?i[o+1]:null,n);r.$addDataNode(s.value,u),r=u}else r=void 0}else if("bracket"===s.type){if(!(r instanceof K&&"array"===r.$type))throw new Error("Looking for index "+s.value+" in non array"+r.$value);var l=s.value;if(l<r.$length)r=r.$getDataNode(l);else if(n){var c=a(s,o<i.length-1?i[o+1]:null,n);r.$addDataNode(l,c),r=c}else r=void 0}o+=1}return r},ae=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},se=["value","label","description","visible","enabled","readOnly","enum","enumNames","required","properties","exclusiveMinimum","exclusiveMaximum","maxLength","maximum","maxItems","minLength","minimum","minItems","step"],ue=[].concat(se,["valid","index","activeChild"]),le=/*#__PURE__*/function(){function e(e,t){this._action=e,this._target=t}return e.prototype.toString=function(){return this._action.toString()},n(e,[{key:"type",get:function(){return this._action.type}},{key:"payload",get:function(){return this._action.payload}},{key:"metadata",get:function(){return this._action.metadata}},{key:"target",get:function(){return this._target}},{key:"isCustomEvent",get:function(){return this._action.isCustomEvent}},{key:"originalAction",get:function(){return this._action.originalAction}}]),e}(),ce=Symbol("target"),he=Symbol("qualifiedName"),de=/*#__PURE__*/function(){function e(e,t){this._callbacks={},this._dependents=[],this._tokens=[],this._options=t,this[he]=null,this._jsonModel=w({},e,{id:"id"in e?e.id:this.form.getUniqueId()})}var t=e.prototype;return t.setupRuleNode=function(){var e=this;this._ruleNode=new Proxy(this.ruleNodeReference(),{get:function(t,n){return e.getFromRule(t,n)}})},t.ruleNodeReference=function(){return this},t.getRuleNode=function(){return this._ruleNode},t.getFromRule=function(t,n){if(n===Symbol.toPrimitive||"valueOf"===n&&!t.hasOwnProperty("valueOf"))return this.valueOf;if(n===ce)return this;if("string"==typeof n)if(n.startsWith("$")){if("function"!=typeof this[n=n.substr(1)]){var i=this[n];return i instanceof e?i.getRuleNode():i instanceof Array?i.map(function(t){return t instanceof e?t.getRuleNode():t}):i}}else{if(t.hasOwnProperty(n))return t[n];if("function"==typeof t[n])return t[n]}},t.isTransparent=function(){var e,t="array"===(null==(e=this.parent)?void 0:e._jsonModel.type);return!this._jsonModel.name&&!t},t.getState=function(){return w({},this._jsonModel,{":type":this[":type"]})},t.subscribe=function(e,t){var n=this;return void 0===t&&(t="change"),this._callbacks[t]=this._callbacks[t]||[],this._callbacks[t].push(e),{unsubscribe:function(){n._callbacks[t]=n._callbacks[t].filter(function(t){return t!==e})}}},t._addDependent=function(e){if(void 0===this._dependents.find(function(t){return t.node===e})){var t=this.subscribe(function(t){var n=t.payload.changes,i=[].concat(ue,["items"]);n.findIndex(function(e){return i.indexOf(e.propertyName)>-1})>-1&&e.dispatch(new q)});this._dependents.push({node:e,subscription:t})}},t.removeDependent=function(e){var t=this._dependents.findIndex(function(t){return t.node===e});t>-1&&(this._dependents[t].subscription.unsubscribe(),this._dependents.splice(t,1))},t.queueEvent=function(e){var t=new le(e,this);this.form.getEventQueue().queue(this,t,["valid","invalid"].indexOf(t.type)>-1)},t.dispatch=function(e){this.queueEvent(e),this.form.getEventQueue().runPendingQueue()},t.notifyDependents=function(e){var t=this;(this._callbacks[e.type]||[]).forEach(function(n){n(new le(e,t))})},t._setProperty=function(e,t,n){void 0===n&&(n=!0);var i=this._jsonModel[e];if(!(null!==t&&null!==i&&"object"==typeof t&&"object"==typeof i?JSON.stringify(t)===JSON.stringify(i):i===t)){this._jsonModel[e]=t;var r=V(e,t,i);return n&&this.notifyDependents(r),r.payload.changes}return[]},t._bindToDataModel=function(e){if("$form"!==this.id){var t,n,i,r=this._jsonModel.dataRef,o=e,a="";if(null===r)t=J;else if(void 0!==r){0===this._tokens.length&&(this._tokens=re(r));var s=e;if("Global"===this._tokens[0].type&&(s=this.form.getDataNode()),void 0!==s){var u=this._tokens[this._tokens.length-1].value,l=this.defaultDataModel(u);t=oe(s,this._tokens,l),o=oe(s,this._tokens.slice(0,-1)),a=u}}else if(e!==J){o=e;var c="array"===e.$type?this.index:this._jsonModel.name||"";if(a=c,""!==c){var h=this.defaultDataModel(c);void 0!==h&&void 0===(t=e.$getDataNode(c))&&e.$addDataNode(c,t=h)}else t=void 0}t&&(this.isContainer||o===J||t===J||(t=null==(i=t)?void 0:i.$convertToDataValue(),o.$addDataNode(a,t,!0)),null==(n=t)||n.$bindToField(this),this._data=t)}else this._data=e},t.getDataNode=function(){return this._data},t.getNonTransparentParent=function(){for(var e=this.parent;null!=e&&e.isTransparent();)e=e.parent;return e},t._initialize=function(){if(void 0===this._data){var e,t=this.parent;do{e=t.getDataNode(),t=t.parent}while(void 0===e);this._bindToDataModel(e)}},t._applyUpdates=function(e,t){var n=this;return e.reduce(function(e,i){var r=n._setProperty(i,t[i],!1);return r.length>0&&(e[i]=r[0]),e},{})},t.focus=function(){this.parent&&(this.parent.activeChild=this)},n(e,[{key:"isContainer",get:function(){return!1}},{key:"id",get:function(){return this._jsonModel.id}},{key:"index",get:function(){return this.parent.indexOf(this)}},{key:"parent",get:function(){return this._options.parent}},{key:"type",get:function(){return this._jsonModel.type}},{key:"fieldType",get:function(){return this._jsonModel.fieldType||"text-input"}},{key:":type",get:function(){return this._jsonModel[":type"]||this.fieldType}},{key:"name",get:function(){return this._jsonModel.name}},{key:"description",get:function(){return this._jsonModel.description},set:function(e){this._setProperty("description",e)}},{key:"dataRef",get:function(){return this._jsonModel.dataRef}},{key:"visible",get:function(){return this._jsonModel.visible},set:function(e){if(e!==this._jsonModel.visible){var t=V("visible",e,this._jsonModel.visible);this._jsonModel.visible=e,this.notifyDependents(t)}}},{key:"form",get:function(){return this._options.form}},{key:"ruleEngine",get:function(){return this.form.ruleEngine}},{key:"label",get:function(){return this._jsonModel.label},set:function(e){if(e!==this._jsonModel.label){var t=V("label",e,this._jsonModel.label);this._jsonModel=w({},this._jsonModel,{label:e}),this.notifyDependents(t)}}},{key:"uniqueItems",get:function(){return this._jsonModel.uniqueItems}},{key:"properties",get:function(){return this._jsonModel.properties||{}},set:function(e){this._setProperty("properties",w({},e))}},{key:"qualifiedName",get:function(){if(this.isTransparent())return null;if(null!==this[he])return this[he];var e=this.getNonTransparentParent();return this[he]=e&&"array"===e.type?e.qualifiedName+"["+this.index+"]":e.qualifiedName+"."+this.name,this[he]}}]),e}();ae([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],de.prototype,"index",null),ae([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],de.prototype,"description",null),ae([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],de.prototype,"visible",null),ae([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],de.prototype,"label",null),ae([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],de.prototype,"properties",null);var fe=/*#__PURE__*/function(e){function t(){var t;return(t=e.call.apply(e,[this].concat([].slice.call(arguments)))||this)._events={},t._rules={},t}r(t,e);var i=t.prototype;return i.getCompiledRule=function(e,t){if(!(e in this._rules)){var n=t||this.rules[e];if(!("string"==typeof n&&n.length>0))throw new Error("only expression strings are supported. "+typeof n+" types are not supported");try{this._rules[e]=this.ruleEngine.compileRule(n)}catch(t){this.form.logger.error('Unable to compile rule `"'+e+'" : "'+n+'"` Exception : '+t)}}return this._rules[e]},i.getCompiledEvent=function(e){var t=this;if(!(e in this._events)){var n,i=null==(n=this._jsonModel.events)?void 0:n[e];"string"==typeof i&&i.length>0&&(i=[i]),void 0!==i&&i.length>0&&(this._events[e]=i.map(function(n){try{return t.ruleEngine.compileRule(n)}catch(n){t.form.logger.error('Unable to compile expression `"'+e+'" : "'+i+'"` Exception : '+n)}return null}).filter(function(e){return null!==e}))}return this._events[e]||[]},i.applyUpdates=function(e){var t=this;Object.entries(e).forEach(function(e){var n=e[0],i=e[1];if(n in se||n in t&&"function"!=typeof t[n])try{t[n]=i}catch(e){console.error(e)}})},i.executeAllRules=function(e){var t=this,n=Object.entries(this.rules);if(n.length>0){var i=this.getExpressionScope();n.forEach(function(n){var r=n[0],o=t.getCompiledRule(r,n[1]);if(o){var a=t.ruleEngine.execute(o,i,e,!0);se.indexOf(r)>-1?t[r]=a:t.form.logger.warn(r+" is not a valid editable property.")}})}},i.getExpressionScope=function(){var e=this.getNonTransparentParent(),t={self:this.getRuleNode(),siblings:(null==e?void 0:e.ruleNodeReference())||{}},n=new Proxy(t,{get:function(e,t){if(t===Symbol.toStringTag)return"Object";if(t.startsWith("$")){var n=e.self[t];return n instanceof de?n.getRuleNode():n instanceof Array?n.map(function(e){return e instanceof de?e.getRuleNode():e}):n}return t in e.siblings?e.siblings[t]:e.self[t]},has:function(e,t){return void 0!==e.self[t]||void 0!==e.siblings[t]}});return n},i.executeEvent=function(e,t){var n;t&&(n=this.ruleEngine.execute(t,this.getExpressionScope(),e)),void 0!==n&&null!=n&&this.applyUpdates(n)},i.executeRule=function(e,t){void 0===e.payload.ruleName&&this.executeAllRules(t)},i.executeExpression=function(e){var t={form:this.form,$form:this.form.getRuleNode(),$field:this.getRuleNode(),field:this},n=this.ruleEngine.compileRule(e);return this.ruleEngine.execute(n,this.getExpressionScope(),t)},i.executeAction=function(e){var t=this,n={form:this.form,$form:this.form.getRuleNode(),$field:this.getRuleNode(),field:this,$event:{type:e.type,payload:e.payload,target:this.getRuleNode()}},i=e.isCustomEvent?"custom_"+e.type:e.type;this.getCompiledEvent(e.isCustomEvent?"custom:"+e.type:e.type).forEach(function(e){return t.executeEvent(n,e)}),i in this&&"function"==typeof this[i]&&this[i](e,n),this.notifyDependents(e)},n(t,[{key:"rules",get:function(){return this._jsonModel.rules||{}}}]),t}(de),pe=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ve=/*#__PURE__*/function(e){function t(){var t;return(t=e.call.apply(e,[this].concat([].slice.call(arguments)))||this)._children=[],t._itemTemplate=null,t._activeChild=null,t}r(t,e);var i=t.prototype;return i.ruleNodeReference=function(){return this._childrenReference},i.hasDynamicItems=function(){return null!=this._itemTemplate},i.getState=function(){return w({},this._jsonModel,{":type":this[":type"],items:this._children.map(function(e){return w({},e.getState())})})},i._addChildToRuleNode=function(e,t){var n=this,i=this,r=t.parent,o=void 0===r?this:r,a="array"==o.type?o._children.length+"":e.name||"";a.length>0&&Object.defineProperty(o._childrenReference,a,{get:function(){return e.isContainer&&e.hasDynamicItems()&&i.ruleEngine.trackDependency(e),i.hasDynamicItems()?(i.ruleEngine.trackDependency(i),void 0!==n._children[a]?n._children[a].getRuleNode():void 0):e.getRuleNode()},configurable:!0,enumerable:!0})},i._addChild=function(e,t,n){void 0===n&&(n=!1);for(var i=this;null!=i&&i.isTransparent();)i=i.parent;("number"!=typeof t||t>i._children.length)&&(t=this._children.length);var r=this.form,o=w({index:t},O(e,n?function(){return r.getUniqueId()}:void 0)),a=this._createChild(o,{parent:this,index:t});return this._addChildToRuleNode(a,{parent:i}),t===this._children.length?this._children.push(a):this._children.splice(t,0,a),a},i.indexOf=function(e){return this._children.indexOf(e)},i.defaultDataModel=function(e){var t=this._jsonModel.type||void 0;if(void 0!==t)return new K(e,"array"===t?[]:{},t)},i._initialize=function(){var t=this;e.prototype._initialize.call(this);var n=this._jsonModel.items;if(this._jsonModel.items=[],this._childrenReference="array"==this._jsonModel.type?[]:{},"array"==this._jsonModel.type&&1===n.length&&null!=this.getDataNode()){this._itemTemplate=O(n[0]),"number"!=typeof this._jsonModel.minItems&&(this._jsonModel.minItems=0),"number"!=typeof this._jsonModel.maxItems&&(this._jsonModel.maxItems=-1),"number"!=typeof this._jsonModel.initialItems&&(this._jsonModel.initialItems=Math.max(1,this._jsonModel.minItems));for(var i=0;i<this._jsonModel.initialItems;i++)this._addChild(this._itemTemplate)._initialize()}else n.length>0&&(n.forEach(function(e){t._addChild(e)._initialize()}),this._jsonModel.minItems=this._children.length,this._jsonModel.maxItems=this._children.length,this._jsonModel.initialItems=this._children.length);this.setupRuleNode()},i.addItem=function(e){if("addItem"===e.type&&null!=this._itemTemplate&&(-1===this._jsonModel.maxItems||this._children.length<this._jsonModel.maxItems)){var t=this.getDataNode(),n=e.payload;("number"!=typeof n||n>this._children.length)&&(n=this._children.length);var i=this._addChild(this._itemTemplate,e.payload,!0),r=i.defaultDataModel(n);r&&t.$addDataNode(n,r),i._initialize(),this.notifyDependents(V("items",i.getState,null)),i.dispatch(new $),i.dispatch(new q);for(var o=n+1;o<this._children.length;o++)this._children[o].dispatch(new q)}},i.removeItem=function(e){if("removeItem"===e.type&&null!=this._itemTemplate){if(0==this._children.length)return;var t="number"==typeof e.payload?e.payload:this._children.length-1,n=this._children[t].getState();if(this._children.length>this._jsonModel.minItems){this._childrenReference.pop(),this._children.splice(t,1),this.getDataNode().$removeDataNode(t);for(var i=t;i<this._children.length;i++)this._children[i].dispatch(new q);this.notifyDependents(V("items",null,n))}}},i.queueEvent=function(t){var n;e.prototype.queueEvent.call(this,t),null!=(n=t.metadata)&&n.dispatch&&this.items.forEach(function(e){e.queueEvent(t)})},i.validate=function(){return this.items.flatMap(function(e){return e.validate()}).filter(function(e){return""!==e.fieldName})},i.dispatch=function(t){e.prototype.dispatch.call(this,t)},i.importData=function(e){this._bindToDataModel(e);var t=this.getDataNode()||e;this.syncDataAndFormModel(t)},i.syncDataAndFormModel=function(e){if("array"===(null==e?void 0:e.$type)&&null!=this._itemTemplate){for(var t=null==e?void 0:e.$value.length,n=this._children.length,i=this._jsonModel.minItems,r=Math.min(t-n,(-1===this._jsonModel.maxItems?t:this._jsonModel.maxItems)-n),o=Math.min(n-t,n-i);r>0;)r--,this._addChild(this._itemTemplate)._initialize();if(o>0){this._children.splice(t,o);for(var a=0;a<o;a++)this._childrenReference.pop()}}this._children.forEach(function(t){t.importData(e)})},n(t,[{key:"items",get:function(){return this._children}},{key:"maxItems",get:function(){return this._jsonModel.maxItems},set:function(e){this._jsonModel.maxItems=e;var t=this._children.length,n=Math.min(t-e,t-(this._jsonModel.minItems||1));if(n>0){for(var i=0;i<n;i++)this.getDataNode().$removeDataNode(e+i),this._childrenReference.pop();var r=this._children.splice(e,n);this.notifyDependents(V("items",r,null))}}},{key:"minItems",get:function(){return this._jsonModel.minItems}},{key:"isContainer",get:function(){return!0}},{key:"activeChild",get:function(){return this._activeChild},set:function(e){if(e!==this._activeChild){for(var n=this._activeChild;n instanceof t;){var i=n.activeChild;n.activeChild=null,n=i}var r=V("activeChild",e,this._activeChild);this._activeChild=e,this.parent&&null!==e&&(this.parent.activeChild=this),this._jsonModel.activeChild=null==e?void 0:e.id,this.notifyDependents(r)}}}]),t}(fe);pe([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],ve.prototype,"maxItems",null),pe([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],ve.prototype,"minItems",null),pe([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],ve.prototype,"activeChild",null);var me=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),n(t,[{key:"version",get:function(){return this.getP("version","")}},{key:"locale",get:function(){return this.getP("locale","")}},{key:"grammar",get:function(){return this.getP("grammar","")}}]),t}(/*#__PURE__*/function(){function e(e){this._jsonModel=w({},e)}return e.prototype.getP=function(e,t){return function(e,t,n){if(t in e)return e[t];if(!t.startsWith(":")){var i=":"+t;if(i in e)return e[i]}return n}(this._jsonModel,e,t)},n(e,[{key:"isContainer",get:function(){return!1}}]),e}()),ge=/*#__PURE__*/function(){function e(e){this.type="application/octet-stream",this.name="unknown",this.size=0,Object.assign(this,e)}var t=e.prototype;return t.toJSON=function(){return{name:this.name,size:this.size,type:this.type,data:this.data.toString()}},t.equals=function(e){return this.data===e.data&&this.type===e.type&&this.name===e.name&&this.size===e.size},e}(),ye="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_".split(""),be=/^(\d*\.?\d+)(\\?(?=[KMGT])([KMGT])(?:i?B)?|B?)$/i,_e=function(e){for(var t=[],n=0;n<=e;n++){var i=Math.floor(Math.random()*ye.length);t.push(ye[i])}return t.join("")},we=function e(t){var n=t.items||[];return null==n?void 0:n.reduce(function(t,n){var i=null;if(n.isContainer)i=e(n);else if(T(n.getState())){i={};var r=null!=n.dataRef?n.dataRef:(n.name||"").length>0?n.name:void 0;n.value instanceof Array?i[n.id]=n.value.map(function(e){return w({},e,{dataRef:r})}):null!=n.value&&(i[n.id]=w({},n.value,{dataRef:r}))}return Object.assign(t,i)},{})},ke=function(e){var t=0;if("string"==typeof e){var n=be.exec(e.trim());null!=n&&(t=Me(parseFloat(n[1]),(n[2]||"kb").toUpperCase()))}return t},Me=function(e,t){var n=Math.pow(1024,{KB:1,MB:2,GB:3,TB:4}[t]);return Math.round(e*n)},je=function(e){var t=/^data:([a-z]+\/[a-z0-9-+.]+)?(?:;name=([^;]+))?(;base64)?,(.+)$/.exec(e);if(null!==t){var n=t[1]||"",i=t[2]||"unknown";if("string"==typeof t[3]){for(var r=atob(t[4]),o=[],a=0;a<r.length;a++)o.push(r.charCodeAt(a));return{name:i,blob:new window.Blob([new Uint8Array(o)],{type:n})}}return{name:i,blob:new window.Blob([t[4]],{type:n})}}return null},De=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,Ee=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/,Se=[31,28,31,30,31,30,31,31,30,31,30,31],xe=function(e){return null!=Ee.exec(e.trim())},Te=function(e){var t=parseFloat(e),n=!isNaN(t);return n||(t=e),{value:t,valid:n}},Oe=function(e){var t=parseFloat(e),n=!isNaN(t)&&Math.round(t)===t;return n||(t=e),{value:t,valid:n}},Le=function(e){return null==e||e instanceof Array?e:[e]},Pe=function(e){var t="boolean"==typeof e||"true"===e||"false"===e;return{valid:t,value:"boolean"==typeof e?e:t?"true"===e:e}},Ne=function(e){var t=function(e){if(null!==e){var t=null;if(e instanceof ge)t=e;else if("undefined"!=typeof File&&e instanceof File)t={name:e.name,type:e.type,size:e.size,data:e};else if("string"==typeof e&&xe(e)){var n=je(e);if(null!==n){var i=n.blob;t={name:n.name,type:i.type,size:i.size,data:i}}}else{var r,o,a=e;try{t=a=JSON.parse(e)}catch(e){}if("string"==typeof(null==(r=a)?void 0:r.data)&&xe(null==(o=a)?void 0:o.data)){var s,u=je(null==(s=a)?void 0:s.data);if(null!==u){var l,c,h=u.blob;t={name:null==(l=a)?void 0:l.name,type:null==(c=a)?void 0:c.type,size:h.size,data:h}}}else if("string"==typeof a)t={name:a.split("/").pop(),type:"application/octet-stream",size:0,data:a};else if("object"==typeof a){var d,f,p,v;t={name:null==(d=a)?void 0:d.name,type:null==(f=a)?void 0:f.type,size:null==(p=a)?void 0:p.size,data:null==(v=a)?void 0:v.data}}}return null!==t&&null!=t.data?new ge(t):null}return null}(e),n=null!==t;return{value:n?t:e,valid:n}},Ie=function(e,t){var n=Le(e);return null==n?[[],[n]]:n.reduce(function(e,n){if(0==e[1].length){var i=t(n);e[i.valid?0:1].push(i.value)}return e},[[],[]])},Ce={date:["minimum","maximum","exclusiveMinimum","exclusiveMaximum","format"],string:["minLength","maxLength","pattern"],number:["minimum","maximum","exclusiveMinimum","exclusiveMaximum"],array:["minItems","maxItems","uniqueItems"],file:["accept","maxFileSize"]},qe={type:function(e,t){var n=t;if(null==t)return{valid:!0,value:t};var i,r=!0;switch(e){case"string":r=!0,n=t.toString();break;case"string[]":n=Le(t);break;case"number":n=(i=Te(t)).value,r=i.valid;break;case"boolean":r=(i=Pe(t)).valid,n=i.value;break;case"integer":r=(i=Oe(t)).valid,n=i.value;break;case"integer[]":n=(r=0===(i=Ie(t,Oe))[1].length)?i[0]:t;break;case"file":r=(i=Ne(t instanceof Array?t[0]:t)).valid,n=i.value;break;case"file[]":n=(r=0===(i=Ie(t,Ne))[1].length)?i[0]:t;break;case"number[]":n=(r=0===(i=Ie(t,Te))[1].length)?i[0]:t;break;case"boolean[]":n=(r=0===(i=Ie(t,Pe))[1].length)?i[0]:t}return{valid:r,value:n}},format:function(e,t){var n,i,r=!0,o=t;if(null===t)return{value:o,valid:r};switch(e){case"date":if(null!=(n=De.exec((t||"").trim()))){var a=+n[2],s=+n[3],u=(i=+n[1])%400==0||i%4==0&&i%100!=0;r=a>=1&&a<=12&&s>=1&&s<=function(e,t){return e&&2==t?29:Se[t-1]}(u,a)}else r=!1;break;case"data-url":r=!0}return{valid:r,value:o}},minimum:function(e,t){return{valid:t>=e,value:t}},maximum:function(e,t){return{valid:t<=e,value:t}},exclusiveMinimum:function(e,t){return{valid:t>e,value:t}},exclusiveMaximum:function(e,t){return{valid:t<e,value:t}},minItems:function(e,t){return{valid:t instanceof Array&&t.length>=e,value:t}},maxItems:function(e,t){return{valid:t instanceof Array&&t.length<=e,value:t}},uniqueItems:function(e,t){return{valid:!e||t instanceof Array&&t.length===new Set(t).size,value:t}},minLength:function(e,t){return w({},qe.minimum(e,"string"==typeof t?t.length:0),{value:t})},maxLength:function(e,t){return w({},qe.maximum(e,"string"==typeof t?t.length:0),{value:t})},pattern:function(e,t){return{valid:("string"==typeof e?new RegExp(e):e).test(t),value:t}},required:function(e,t){return{valid:!e||null!=t&&""!==t,value:t}},enum:function(e,t){return{valid:e.indexOf(t)>-1,value:t}},accept:function(e,t){return e&&0!==e.length&&null!=t?{valid:!(t instanceof Array?t:[t]).some(function(t){return!(!(n=t.type)||e.some(function(e){var t=e.trim(),i=t.split("/")[0],r=t.split(".")[1];return t.includes("*")&&n.startsWith(i)||t.includes(".")&&n.endsWith(r)||t===n}));var n}),value:t}:{valid:!0,value:t}},maxFileSize:function(e,t){var n="string"==typeof e?ke(e):e;return{valid:!(t instanceof ge)||t.size<=n,value:t}}},Ve=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},$e=/*#__PURE__*/function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this)._ruleNodeReference=[],i._applyDefaults(),i.queueEvent(new $),i.queueEvent(new q),i}r(t,e);var i=t.prototype;return i._initialize=function(){e.prototype._initialize.call(this),this.setupRuleNode()},i.ruleNodeReference=function(){var e;return this._ruleNodeReference=null!=(e=this.type)&&e.endsWith("[]")?[]:this,this._ruleNodeReference},i._getDefaults=function(){return{readOnly:!1,enabled:!0,visible:!0,type:this._getFallbackType()}},i._getFallbackType=function(){if("string"!=typeof this._jsonModel.type){var e=this.enum;return e&&e.length>0?typeof e[0]:"string"}},i._applyDefaults=function(){var e=this;if(Object.entries(this._getDefaults()).map(function(t){var n=t[0],i=t[1];void 0===e._jsonModel[n]&&void 0!==i&&(e._jsonModel[n]=i)}),void 0===this._jsonModel.value){var t=qe.type(this.getInternalType()||"string",this._jsonModel.default);this._jsonModel.value=t.value}void 0===this._jsonModel.fieldType&&(this._jsonModel.viewType?(this._jsonModel.viewType.startsWith("custom:")?this.form.logger.error("viewType property has been removed. For custom types, use :type property"):this.form.logger.error("viewType property has been removed. Use fieldType property"),this._jsonModel.fieldType=this._jsonModel.viewType):this._jsonModel.fieldType=x(this._jsonModel)),void 0===this._jsonModel.enum&&"boolean"===this._jsonModel.type&&(this._jsonModel.enum=[!0,!1]),"number"==typeof this._jsonModel.step&&"number"===this._jsonModel.type||(this._jsonModel.step=void 0)},i.isEmpty=function(){return null==this._jsonModel.value||""===this._jsonModel.value},i.getDataNodeValue=function(e){return this.isEmpty()?this.emptyValue:e},i._updateRuleNodeReference=function(e){var t,n=this;if(null!=(t=this.type)&&t.endsWith("[]"))if(null!=e)for(e.forEach(function(e,t){n._ruleNodeReference[t]=e});e.length!==this._ruleNodeReference.length;)this._ruleNodeReference.pop();else for(;0!==this._ruleNodeReference.length;)this._ruleNodeReference.pop()},i.getInternalType=function(){return this.type},i.valueOf=function(){var e=this[ce],t=void 0===e?this:e;return t.ruleEngine.trackDependency(t),t._jsonModel.value||null},i.toString=function(){var e,t=this[ce];return(null==(e=(void 0===t?this:t)._jsonModel.value)?void 0:e.toString())||""},i.getErrorMessage=function(e){var t;return(null==(t=this._jsonModel.constraintMessages)?void 0:t[e])||""},i._getConstraintObject=function(){return qe},i.isArrayType=function(){return!!this.type&&this.type.indexOf("[]")>-1},i.checkEnum=function(e,t){var n=this;if(!0===this._jsonModel.enforceEnum&&null!=e){var i=t.enum;return e instanceof Array&&this.isArrayType()?e.every(function(e){return i(n.enum||[],e).valid}):i(this.enum||[],e).valid}return!0},i.checkStep=function(){return"number"!=typeof this._jsonModel.step||(this._jsonModel.value-(this._jsonModel.minimum||this._jsonModel.default||0))%this._jsonModel.step==0},i.checkValidationExpression=function(){return"string"!=typeof this._jsonModel.validationExpression||this.executeExpression(this._jsonModel.validationExpression)},i.getConstraints=function(){switch(this.type){case"string":switch(this.format){case"date":return Ce.date;case"binary":case"data-url":return Ce.file;default:return Ce.string}case"file":return Ce.file;case"number":case"integer":return Ce.number}return this.isArrayType()?Ce.array:[]},i.evaluateConstraints=function(){var e=this,t="type",n=this._jsonModel,i=this._jsonModel.value,r=this._getConstraintObject(),o=this.getConstraints(),a=!0;if(a&&(a=r.required(this.required,i).valid&&(!this.isArrayType()||!this.required||i.length>0),t="required"),a&&i!=this.emptyValue){var s=o.find(function(t){if(t in n){var o=n[t],a=r[t];return i instanceof Array&&e.isArrayType()?-1!==Ce.array.indexOf(t)?!a(o,i).valid:i.some(function(e){return!a(o,e).valid}):"function"==typeof a&&!a(o,i).valid}return!1});null!=s?(a=!1,t=s):(t="enum",(a=this.checkEnum(i,r))&&"number"===this.type&&(a=this.checkStep(),t="step"),a&&(a=this.checkValidationExpression(),t="validationExpression"))}a||this.form.logger.log(t+" constraint evaluation failed "+this[t]+". Received "+this._jsonModel.value);var u={valid:a,errorMessage:a?"":this.getErrorMessage(t)};return this._applyUpdates(["valid","errorMessage"],u)},i.triggerValidationEvent=function(e){e.valid&&this.dispatch(this.valid?new C:new I)},i.validate=function(){var e=this.evaluateConstraints();return e.valid&&(this.triggerValidationEvent(e),this.notifyDependents(new N({changes:Object.values(e)}))),this.valid?[]:[new M(this.id,[this._jsonModel.errorMessage])]},i.importData=function(e){this._bindToDataModel(e);var t=this.getDataNode();if(void 0!==t&&t!==J&&t.$value!==this._jsonModel.value){var n=V("value",t.$value,this._jsonModel.value);this._jsonModel.value=t.$value,this.queueEvent(n)}},i.defaultDataModel=function(e){return new G(e,this.getDataNodeValue(this._jsonModel.value),this.type||"string")},i.getState=function(){return w({},e.prototype.getState.call(this),{editValue:this.editValue,displayValue:this.displayValue})},n(t,[{key:"editFormat",get:function(){return this._jsonModel.editFormat}},{key:"displayFormat",get:function(){return this._jsonModel.displayFormat}},{key:"placeholder",get:function(){return this._jsonModel.placeholder}},{key:"readOnly",get:function(){return this._jsonModel.readOnly},set:function(e){this._setProperty("readOnly",e)}},{key:"language",get:function(){return Intl.DateTimeFormat().resolvedOptions().locale}},{key:"enabled",get:function(){return this._jsonModel.enabled},set:function(e){this._setProperty("enabled",e)}},{key:"valid",get:function(){return this._jsonModel.valid}},{key:"emptyValue",get:function(){return"null"===this._jsonModel.emptyValue?null:""===this._jsonModel.emptyValue&&"string"===this.type?"":void 0}},{key:"enum",get:function(){return this._jsonModel.enum},set:function(e){this._setProperty("enum",e)}},{key:"enumNames",get:function(){return this._jsonModel.enumNames},set:function(e){this._setProperty("enumNames",e)}},{key:"required",get:function(){return this._jsonModel.required||!1},set:function(e){this._setProperty("required",e)}},{key:"maximum",get:function(){return this._jsonModel.maximum},set:function(e){this._setProperty("maximum",e)}},{key:"minimum",get:function(){return this._jsonModel.minimum},set:function(e){this._setProperty("minimum",e)}},{key:"editValue",get:function(){var e=this.editFormat;return"date"==this.format&&null!=this.value&&!1!==this.valid?_.formatDate(new Date(this.value),this.language,e):this.value}},{key:"displayValue",get:function(){var e=this.displayFormat;return"date"==this.format&&null!=this.value&&!1!==this.valid?_.formatDate(new Date(this.value),this.language,e):this.value}},{key:"value",get:function(){return void 0===this._jsonModel.value?null:this._jsonModel.value},set:function(e){var t=this._getConstraintObject(),n=t.type(this.getInternalType()||"string",e),i=this._setProperty("value",n.value,!1),r={valid:!0};if(i.length>0){this._updateRuleNodeReference(n.value);var o,a=this.getDataNode();if(void 0!==a&&a.setValue(this.getDataNodeValue(this._jsonModel.value),this._jsonModel.value,this),this.parent.uniqueItems&&"array"===this.parent.type&&(r=t.uniqueItems(this.parent.uniqueItems,this.parent.getDataNode().$value)),n.valid&&r.valid)o=this.evaluateConstraints();else{var s={valid:n.valid&&r.valid,errorMessage:n.valid&&r.valid?"":this.getErrorMessage("type")};o=this._applyUpdates(["valid","errorMessage"],s)}o.valid&&this.triggerValidationEvent(o);var u=new N({changes:i.concat(Object.values(o))});this.dispatch(u)}}},{key:"format",get:function(){return this._jsonModel.format||""}}]),t}(fe);function Ae(e,t){return e.replace(";base64",";name="+encodeURIComponent(t)+";base64")}Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"readOnly",null),Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"enabled",null),Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"valid",null),Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"enum",null),Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"enumNames",null),Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"required",null),Ve([function(e,t,n){var i=n.get;null!=i&&(n.get=function(){return this.ruleEngine.trackDependency(this),i.call(this)})}],$e.prototype,"value",null);var Fe=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var i=t.prototype;return i._getDefaults=function(){return w({},e.prototype._getDefaults.call(this),{accept:["audio/*","video/*","image/*","text/*","application/pdf"],maxFileSize:"2MB",type:"file"})},i._applyUpdates=function(e,t){var n=this;return e.reduce(function(e,i){var r=n._jsonModel[i],o=t[i];return o!==r&&(e[i]={propertyName:i,currentValue:o,prevValue:r},n._jsonModel[i]=r instanceof ge&&"object"==typeof o&&"value"===i?new ge(w({},r,{data:o.data})):o),e},{})},i.getInternalType=function(){var e;return null!=(e=this.type)&&e.endsWith("[]")?"file[]":"file"},i.getDataNodeValue=function(e){var t,n=e;return null!=n&&("string"===this.type?n=null==(t=n.data)?void 0:t.toString():"string[]"===this.type&&(n=(n=n instanceof Array?n:[n]).map(function(e){var t;return null==e||null==(t=e.data)?void 0:t.toString()}))),n},i._serialize=function(){try{var e=this._jsonModel.value;return Promise.resolve(void 0===e?null:Promise.all([].map.call(e instanceof Array?e:[e],k)))}catch(e){return Promise.reject(e)}},i.importData=function(e){this._bindToDataModel(e);var t=this.getDataNode();if(void 0!==t){var n=null==t?void 0:t.$value;if(null!=n){var i=qe.type(this.getInternalType(),n);i.valid||this.form.logger.error("unable to bind "+this.name+" to data"),this.form.getEventQueue().queue(this,V("value",i.value,this._jsonModel.value)),this._jsonModel.value=i.value}else this._jsonModel.value=null}},n(t,[{key:"maxFileSize",get:function(){return ke(this._jsonModel.maxFileSize)}},{key:"accept",get:function(){return this._jsonModel.accept}}]),t}($e),Re=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var i=t.prototype;return i.offValue=function(){var e=this.enum;return e.length>1?e[1]:null},i._getConstraintObject=function(){var t,n=w({},e.prototype._getConstraintObject.call(this));return n.required=(t=this.offValue(),function(e,n){return{valid:qe.required(e,n).valid&&(!e||n!=t),value:n}}),n},i._getDefaults=function(){return w({},e.prototype._getDefaults.call(this),{enforceEnum:!0})},n(t,[{key:"enum",get:function(){return this._jsonModel.enum||[]}}]),t}($e),Be=/*#__PURE__*/function(e){function t(t,n){return e.call(this,t,n)||this}r(t,e);var n=t.prototype;return n._getFallbackType=function(){var t=e.prototype._getFallbackType.call(this);if("string"==typeof t)return t+"[]"},n._getDefaults=function(){return w({},e.prototype._getDefaults.call(this),{enforceEnum:!0,enum:[]})},t}($e),He=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype._applyDefaults=function(){e.prototype._applyDefaults.call(this);var t=(new Intl.DateTimeFormat).resolvedOptions().locale;this._jsonModel.editFormat||(this._jsonModel.editFormat="short"),this._jsonModel.displayFormat||(this._jsonModel.displayFormat=this._jsonModel.editFormat),this._jsonModel.placeholder||(this._jsonModel.placeholder=_.getSkeleton(this._jsonModel.editFormat,t)),this._jsonModel.description||(this._jsonModel.description="To enter today's date use "+_.formatDate(new Date,t,this._jsonModel.editFormat))},t}($e),ze=function(e,t){var n,i;return n="items"in e?new Ue(e,t):T(e)||"file-input"===e.fieldType?new Fe(e,t):"checkbox"===((null==(i=e)?void 0:i.fieldType)||x(i))?new Re(e,t):function(e){return"checkbox-group"===((null==e?void 0:e.fieldType)||x(e))}(e)?new Be(e,t):function(e){var t=(null==e?void 0:e.fieldType)||x(e);return"text-input"===t&&"date"===(null==e?void 0:e.format)||"date-input"===t}(e)?new He(e,t):new $e(e,t),t.form.fieldAdded(n),n},We={visible:!0},Ue=/*#__PURE__*/function(e){function t(t,n){var i;return(i=e.call(this,t,n)||this)._applyDefaults(),i.queueEvent(new $),i.queueEvent(new q),i}r(t,e);var i=t.prototype;return i._applyDefaults=function(){var e=this;Object.entries(We).map(function(t){var n=t[0];void 0===e._jsonModel[n]&&(e._jsonModel[n]=t[1])}),this._jsonModel.dataRef&&void 0===this._jsonModel.type&&(this._jsonModel.type="object")},i._createChild=function(e,t){var n=t.parent;return ze(e,{form:this.form,parent:void 0===n?this:n})},n(t,[{key:"type",get:function(){var t=e.prototype.type;if("array"===t||"object"===t)return t}},{key:"items",get:function(){return e.prototype.items}},{key:"value",get:function(){return null}},{key:"fieldType",get:function(){return"panel"}},{key:"enabled",get:function(){return this._jsonModel.enabled},set:function(e){this._setProperty("enabled",e)}}]),t}(ve),Qe={off:0,debug:1,info:2,warn:3,error:4},Ge=/*#__PURE__*/function(){var e=t.prototype;function t(e){void 0===e&&(e="off"),this.logLevel=Qe[e]}return e.debug=function(e){this.log(e,"debug")},e.info=function(e){this.log(e,"info")},e.warn=function(e){this.log(e,"warn")},e.error=function(e){this.log(e,"error")},e.log=function(e,t){0!==this.logLevel&&this.logLevel<=Qe[t]&&console[t](e)},t}(),Ze=/*#__PURE__*/function(){function e(e,t){this._node=e,this._event=t}var t=e.prototype;return t.isEqual=function(e){return null!=e&&this._node==e._node&&this._event.type==e._event.type},t.toString=function(){return this._node.id+"__"+this.event.type},t.valueOf=function(){return this.toString()},n(e,[{key:"node",get:function(){return this._node}},{key:"event",get:function(){return this._event}}]),e}(),Je=/*#__PURE__*/function(){function e(e){void 0===e&&(e=new Ge("off")),this._isProcessing=!1,this._pendingEvents=[],this.logger=e,this._runningEventCount={}}var t=e.prototype;return t.isQueued=function(e,t){var n=new Ze(e,t);return void 0!==this._pendingEvents.find(function(e){return n.isEqual(e)})},t.queue=function(t,n,i){var r=this;void 0===i&&(i=!1),t&&n&&(n instanceof Array||(n=[n]),n.forEach(function(n){var o=new Ze(t,n),a=r._runningEventCount[o.valueOf()]||0;a<e.MAX_EVENT_CYCLE_COUNT?(r.logger.info("Queued event : "+n.type+" node: "+t.id+" - "+t.name),i?r._pendingEvents.splice(r._isProcessing?1:0,0,o):r._pendingEvents.push(o),r._runningEventCount[o.valueOf()]=a+1):r.logger.info("Skipped queueing event : "+n.type+" node: "+t.id+" - "+t.name+" with count="+a)}))},t.runPendingQueue=function(){if(!this._isProcessing){for(this._isProcessing=!0;this._pendingEvents.length>0;){var e=this._pendingEvents[0];this.logger.info("Dequeued event : "+e.event.type+" node: "+e.node.id+" - "+e.node.name),e.node.executeAction(e.event),this._pendingEvents.shift()}this._runningEventCount={},this._isProcessing=!1}},n(e,[{key:"length",get:function(){return this._pendingEvents.length}},{key:"isProcessing",get:function(){return this._isProcessing}}]),e}();Je.MAX_EVENT_CYCLE_COUNT=10;var Ke={method:"GET"},Ye=function(e){var t=e;return t.length>0&&t.startsWith("custom:")?t.substring("custom:".length):t},Xe=function(e,t,n,i,r,o,a){try{var s,u,l,c=function(t){if(s)return t;var n=Ye(r);e.form.dispatch(new W(n,u,!0))},h=t,d={method:n},f=function(e,t){try{var n=e()}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(function(){if(i&&i instanceof ge&&i.data instanceof File){var e=new FormData;e.append(i.name,i.data),l=e}else if(i instanceof FormData)l=i;else if(i&&"object"==typeof i&&Object.keys(i).length>0){var t,n=Object.keys(a);d.headers=n.length>0?w({},a,-1===n.indexOf("Content-Type")?{"Content-Type":"application/json"}:{}):{"Content-Type":"application/json"};var r=(null==d||null==(t=d.headers)?void 0:t["Content-Type"])||"application/json";"application/json"===r?l=JSON.stringify(i):r.indexOf("multipart/form-data")>-1?l=tt(i):r.indexOf("application/x-www-form-urlencoded")>-1&&(l=et(i))}return Promise.resolve(function(e,t,n){void 0===t&&(t=null),void 0===n&&(n={});var i=w({},Ke,n);return fetch(e,w({},i,{body:t})).then(function(e){var t;if(!e.ok)throw new Error(e.statusText);return null!=e&&null!=(t=e.headers.get("Content-Type"))&&t.includes("application/json")?e.json():e.text()})}(h,l,d)).then(function(e){u=e})},function(){e.form.logger.error("Error invoking a rest API");var t=Ye(o);e.form.dispatch(new W(t,{},!0)),s=1});return Promise.resolve(f&&f.then?f.then(c):c(f))}catch(e){return Promise.reject(e)}},et=function(e){var t=new URLSearchParams;return Object.entries(e).forEach(function(e){var n=e[1];t.append(e[0],null!=n&&"object"==typeof n?L(n):n)}),t},tt=function(e,t){var n=new FormData;Object.entries(e).forEach(function(e){var t=e[1];n.append(e[0],null!=t&&"object"==typeof t?L(t):t)});var i=function(e,t){if((null==e?void 0:e.data)instanceof File){var n=(null==e?void 0:e.dataRef)+"/"+(null==e?void 0:e.name);n.startsWith("/")||(n="/"+n),t.append(n,e.data)}};return t&&Object.keys(t).reduce(function(e,r){var o=t[r];return[].concat(e,o&&o instanceof Array?o.map(function(e){return i(e,n)}):[i(o,n)])},[]),n},nt=new(/*#__PURE__*/function(){function e(){this.customFunctions={}}var t=e.prototype;return t.registerFunctions=function(e){var t=this;Object.entries(e).forEach(function(e){var n=e[0],i=e[1],r=i;"function"==typeof i&&(r={_func:function(e){return i.apply(void 0,e)},_signature:[]}),r.hasOwnProperty("_func")?t.customFunctions[n]=r:console.warn("Unable to register function with name "+n+".")})},t.unregisterFunctions=function(){var e=this;[].slice.call(arguments).forEach(function(t){t in e.customFunctions&&delete e.customFunctions[t]})},t.getFunctions=function(){function e(t){return null==t?t:null!==(n=t)&&"[object Array]"===Object.prototype.toString.call(n)?t.map(function(t){return e(t)}):t.valueOf();var n}function t(e){return null==e?"":e.toString()}return w({},{validate:{_func:function(e,t,n){var i,r=e[0];return i="string"==typeof r||void 0===r?n.globals.form.validate():n.globals.form.getElement(r.$id).validate(),Array.isArray(i)&&i.length&&n.globals.form.logger.error("Form Validation Error"),i},_signature:[]},setFocus:{_func:function(e,t,n){var i=e[0];try{var r=n.globals.form.getElement(i.$id);n.globals.form.setFocus(r)}catch(e){n.globals.form.logger.error("Invalid argument passed in setFocus. An element is expected")}},_signature:[]},getData:{_func:function(e,t,n){return n.globals.form.logger.warn("The `getData` function is depricated. Use `exportData` instead."),n.globals.form.exportData()},_signature:[]},exportData:{_func:function(e,t,n){return n.globals.form.exportData()},_signature:[]},importData:{_func:function(e,t,n){var i=e[0];return"object"==typeof i&&null!==i&&n.globals.form.importData(i),{}},_signature:[]},submitForm:{_func:function(n,i,r){var o=t(n[0]),a=t(n[1]),s=n.length>2?t(n[2]):"multipart/form-data",u=n.length>3?e(n[3]):null;return r.globals.form.dispatch(new H({success:o,error:a,submit_as:s,data:u})),{}},_signature:[]},request:{_func:function(n,i,r){var o,a,s=t(n[0]),u=t(n[1]),l=e(n[2]),c={};return"string"==typeof n[3]?(r.globals.form.logger.warn("This usage of request is deprecated. Please see the documentation and update"),o=e(n[3]),a=e(n[4])):(c=e(n[3]),o=e(n[4]),a=e(n[5])),Xe(r.globals,s,u,l,o,a,c),{}},_signature:[]},dispatchEvent:{_func:function(t,n,i){var r,o=t[0],a=e(t[1]),s=t.length>2?e(t[2]):void 0,u=!1;return"string"==typeof o&&(s=a,a=o,u=!0),r=a.startsWith("custom:")?new W(a.substring("custom:".length),s,u):function(e,t){switch(void 0===t&&(t={}),e){case"change":return new N(t);case"submit":return new H(t);case"click":return new F(t);case"addItem":return new U(t);case"removeItem":return new Q(t);default:console.error("invalid action")}}(a,s),null!=r&&("string"==typeof o?i.globals.form.dispatch(r):i.globals.form.getElement(o.$id).dispatch(r)),{}},_signature:[]}},this.customFunctions)},e}()),it=/*#__PURE__*/function(t){function i(n,i,r,o){var a,s;return void 0===r&&(r=new Je),void 0===o&&(o="off"),(a=t.call(this,n,{})||this)._fields={},a._invalidFields=[],a.dataRefRegex=/("[^"]+?"|[^.]+?)(?:\.|$)/g,a._ruleEngine=i,a._eventQueue=r,a._logger=new Ge(o),a.queueEvent(new $),a.queueEvent(new q),a._ids=(void 0===s&&(s=50),/*#__PURE__*/e().mark(function t(){var n,i,r,o;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i={},r=(n=function(){for(var e=[],t=0;t<s;t++)e.push(_e(10));return e})();case 3:for(o=r.pop();o in i;)0===r.length&&(r=n()),o=r.pop();return i[o]=!0,e.next=8,r.pop();case 8:0===r.length&&(r=n());case 9:if(r.length>0){e.next=3;break}case 10:case"end":return e.stop()}},t)})()),a._bindToDataModel(new K("$form",{})),a._initialize(),a.queueEvent(new A),a}r(i,t);var o=i.prototype;return o._createChild=function(e){return ze(e,{form:this,parent:this})},o.importData=function(e){this._bindToDataModel(new K("$form",e)),this.syncDataAndFormModel(this.getDataNode()),this._eventQueue.runPendingQueue()},o.exportData=function(){var e;return null==(e=this.getDataNode())?void 0:e.$value},o.setFocus=function(e){for(var t=e.parent,n=e;null!=t&&t.activeChild!=n;)t.activeChild=n},o.getState=function(){var e=this,n=t.prototype.getState.call(this);return n.id="$form",Object.defineProperty(n,"data",{get:function(){return e.exportData()}}),Object.defineProperty(n,"attachments",{get:function(){return we(e)}}),n},o.isTransparent=function(){return!1},o.getUniqueId=function(){return null==this._ids?"":this._ids.next().value},o.fieldAdded=function(e){var t=this;this._fields[e.id]=e,e.subscribe(function(e){-1===t._invalidFields.indexOf(e.target.id)&&t._invalidFields.push(e.target.id)},"invalid"),e.subscribe(function(e){var n=t._invalidFields.indexOf(e.target.id);n>-1&&t._invalidFields.splice(n,1)},"valid"),e.subscribe(function(e){var n=e.target.getState();if(n){var i=new z(e.payload.changes,n);t.dispatch(i)}})},o.validate=function(){var e=t.prototype.validate.call(this);return this.dispatch(new B(e)),e},o.isValid=function(){return 0===this._invalidFields.length},o.dispatch=function(e){"submit"===e.type?(t.prototype.queueEvent.call(this,e),this._eventQueue.runPendingQueue()):t.prototype.dispatch.call(this,e)},o.executeAction=function(e){"submit"===e.type&&0!==this._invalidFields.length||t.prototype.executeAction.call(this,e)},o.submit=function(e,t){if(0===this.validate().length){var n=(null==e?void 0:e.payload)||{};!function(e,t,n,i,r){void 0===i&&(i="multipart/form-data"),void 0===r&&(r=null);try{var o=e.form.action,a=r;"object"==typeof a&&null!=a||(a=e.form.exportData());var s,u=we(e.form),l=i;Object.keys(u).length>0||"multipart/form-data"===i?(s=tt({data:a},u),l="multipart/form-data"):s={data:a},Promise.resolve(Xe(e,o,"POST",s,t,n,{"Content-Type":l})).then(function(){})}catch(e){return Promise.reject(e)}}(t,null==n?void 0:n.success,null==n?void 0:n.error,null==n?void 0:n.submit_as,null==n?void 0:n.data)}},o.getElement=function(e){return e==this.id?this:this._fields[e]},o.getEventQueue=function(){return this._eventQueue},n(i,[{key:"logger",get:function(){return this._logger}},{key:"metaData",get:function(){return new me(this._jsonModel.metadata||{})}},{key:"action",get:function(){return this._jsonModel.action}},{key:"type",get:function(){return"object"}},{key:"form",get:function(){return this}},{key:"ruleEngine",get:function(){return this._ruleEngine}},{key:"qualifiedName",get:function(){return"$form"}},{key:"name",get:function(){return"$form"}},{key:"value",get:function(){return null}},{key:"id",get:function(){return"$form"}},{key:"title",get:function(){return this._jsonModel.title||""}}]),i}(ve),rt=/*#__PURE__*/function(){function e(){this._globalNames=["$form","$field","$event"]}var t=e.prototype;return t.compileRule=function(e){var t=nt.getFunctions();return new Formula(e,t,void 0,this._globalNames)},t.execute=function(e,t,n,i){void 0===i&&(i=!1);var r=this._context;this._context=n;var o=void 0;try{e.debug=[],o=e.search(t,n)}catch(e){var s,u,l;null==(s=this._context)||null==(u=s.form)||null==(l=u.logger)||l.error(e)}for(var c,h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.debug);!(c=h()).done;){var d,f,p;null==(d=this._context)||null==(f=d.form)||null==(p=f.logger)||p.debug(c.value)}var v=o;return i&&"object"==typeof o&&null!==o&&(v=Object.getPrototypeOf(o).valueOf.call(o)),this._context=r,v},t.trackDependency=function(e){this._context&&void 0!==this._context.field&&this._context.field!==e&&e._addDependent(this._context.field)},e}(),ot=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.getInputHTML=function(){return'<textarea\n              title="'+(this.isTooltipVisible()?this.getTooltipValue():"")+'"\n              aria-label="'+(this.isLabelVisible()?this.getLabelValue():"")+'"\n              class="cmp-adaptiveform-textinput__widget"\n              name="'+this.getName()+'"\n              '+this.getDisabledHTML()+"\n              "+this.getReadonlyHTML()+'\n              required="'+this.isRequired()+'"\n              placeholder="'+this.getPlaceHolder()+'"\n              minlength="'+this.getMinLength()+'"\n              maxlength="'+this.getMaxLength()+'"></textarea>'},t}(d),at=/*#__PURE__*/u("checkIfEqual"),st=/*#__PURE__*/function(e){function t(n,i){var r;return r=e.call(this,n,i)||this,Object.defineProperty(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r),at,{writable:!0,value:function(e,t,n){if(n){var i=!1;return e.forEach(function(e){String(e)===t&&(i=!0)}),i}return String(e)===t}}),r.qm=r.element.querySelector(t.selectors.qm),r}r(t,e);var n=t.prototype;return n.getWidget=function(){return this.element.querySelector(t.selectors.widget)},n.getDescription=function(){return this.element.querySelector(t.selectors.description)},n.getLabel=function(){return this.element.querySelector(t.selectors.label)},n.getErrorDiv=function(){return this.element.querySelector(t.selectors.errorDiv)},n.getQuestionMarkDiv=function(){return this.element.querySelector(t.selectors.qm)},n.getTooltipDiv=function(){return this.element.querySelector(t.selectors.tooltipDiv)},n._updateValue=function(e){var t=this,n=this._model.isArrayType();this.widget&&[this.widget].forEach(function(i){l(t,at)[at](e,i.value,n)?i.setAttribute("selected","selected"):i.removeAttribute("selected")})},n.addListener=function(){var e,t=this;null==(e=this.getWidget())||e.addEventListener("blur",function(e){if(t._model.isArrayType()){var n=[];[t.widget].forEach(function(e){e.selected&&n.push(e.value)}),t._model.value=n}else t._model.value=e.target.value})},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getInputHTML=function(){var e,t,n=this;return'<select class="cmp-adaptiveform-dropdown__widget"\n                    aria-label="'+(this.isLabelVisible()?this.getLabelValue():"")+'"\n                    title="'+(this.isTooltipVisible()?this.getTooltipValue():"")+'"\n                    name="'+this.getName()+'"\n                    '+this.getDisabledHTML()+"\n                    "+this.getReadonlyHTML()+"\n                    "+this.getMultipleHTML()+'\n                    required="'+this.isRequired()+'">\n                '+(this.getPlaceHolder()?'<option  value="" disabled selected>'+this.getPlaceHolder()+"</option>":"")+"\n                \n                "+(null==(e=this.getState())||null==(t=e.enumNames)?void 0:t.map(function(e,t){var i;return n.getOptionsHTML(null==(i=n.getState())?void 0:i.enum[t],e,n.getDefault())}).join(""))+"\n            </select>"},n.getOptionsHTML=function(e,t,n){return'\n            <option value="'+e+'" class="cmp-adaptiveform-dropdown__option"\n                selected="'+(e==n?"selected":"")+'">'+t+"</option>\n            "},n.getMultipleHTML=function(){return(this.getState().isMultiSelect?"multiple: multiple":"")+'"'},t}(h);st.NS="cmp",st.IS="adaptiveFormDropDown",st.bemBlock="cmp-adaptiveform-dropdown",st.selectors={self:"[data-"+st.NS+'-is="'+st.IS+'"]',widget:"."+st.bemBlock+"__widget",options:"."+st.bemBlock+"__option",label:"."+st.bemBlock+"__label",description:"."+st.bemBlock+"__longdescription",qm:"."+st.bemBlock+"__questionmark",errorDiv:"."+st.bemBlock+"__errormessage",tooltipDiv:"."+st.bemBlock+"__shortdescription"};var ut={Click:F,Change:N,Submit:H,Blur:R,AddItem:U,RemoveItem:Q},lt=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.getQuestionMarkDiv=function(){return null},n.getLabel=function(){return null},n.getWidget=function(){return this.element.querySelector(".cmp-button")},n.getDescription=function(){return null},n.getErrorDiv=function(){return null},n.getTooltipDiv=function(){return null},n.addListener=function(){var e,t=this;null==(e=this.getWidget())||e.addEventListener("click",function(){t._model.dispatch(new ut.Click)})},n.getbemBlock=function(){return t.bemBlock},n.getHTML=function(){return'<button \n            type="button"\n            id="'+this.id+'"\n            class="cmp-button"\n            '+this.getDisabledHTML()+"\n            "+this.getReadonlyHTML()+'\n            title="'+this.getTooltipValue+'"\n            data-cmp-visible="'+this.isVisible()+'"\n            data-cmp-enabled="'+this.isEnabled()+'"\n            data-cmp-is="adaptiveFormButton"\n            aria-label="'+this.getLabelValue()+'"\n            data-cmp-adaptiveformcontainer-path="'+this.getFormContainerPath()+'">\n            <span class="cmp-button__text">'+this.getLabelValue()+"</span>\n        </button>"},t}(h);lt.NS="cmp",lt.IS="adaptiveFormButton",lt.bemBlock="cmp-adaptiveform-button",lt.selectors={self:"[data-"+lt.NS+'-is="'+lt.IS+'"]'};var ct=/*#__PURE__*/u("widget"),ht=/*#__PURE__*/u("model"),dt=/*#__PURE__*/u("options"),ft=/*#__PURE__*/u("defaultOptions"),pt=/*#__PURE__*/u("matchArray"),vt=/*#__PURE__*/u("regex"),mt=/*#__PURE__*/u("processedValue"),gt=/*#__PURE__*/u("engRegex"),yt=/*#__PURE__*/u("writtenInLocale"),bt=/*#__PURE__*/u("previousCompositionVal"),_t=/*#__PURE__*/u("toLatinForm"),wt=/*#__PURE__*/u("attachEventHandlers"),kt=/*#__PURE__*/u("attachCompositionEventHandlers"),Mt=/*#__PURE__*/u("getDigits"),jt=/*#__PURE__*/u("escape"),Dt=/*#__PURE__*/u("compositionUpdateCallback"),Et=/*#__PURE__*/u("handleKeyInput"),St=/*#__PURE__*/u("handleKeyDown"),xt=/*#__PURE__*/u("isValidChar"),Tt=/*#__PURE__*/u("handleKeyPress"),Ot=/*#__PURE__*/u("handlePaste"),Lt=/*#__PURE__*/u("handleCut"),Pt=/*#__PURE__*/u("convertValueToLocale"),Nt=/*#__PURE__*/u("convertValueFromLocale"),It=/*#__PURE__*/u("isValueSame"),Ct=/*#__PURE__*/function(){function e(e,t){if(Object.defineProperty(this,It,{value:Jt}),Object.defineProperty(this,Nt,{value:Zt}),Object.defineProperty(this,Pt,{value:Gt}),Object.defineProperty(this,Lt,{value:Qt}),Object.defineProperty(this,Ot,{value:Ut}),Object.defineProperty(this,Tt,{value:Wt}),Object.defineProperty(this,xt,{value:zt}),Object.defineProperty(this,St,{value:Ht}),Object.defineProperty(this,Et,{value:Bt}),Object.defineProperty(this,Dt,{value:Rt}),Object.defineProperty(this,jt,{value:Ft}),Object.defineProperty(this,Mt,{value:At}),Object.defineProperty(this,kt,{value:$t}),Object.defineProperty(this,wt,{value:Vt}),Object.defineProperty(this,_t,{value:qt}),Object.defineProperty(this,ct,{writable:!0,value:null}),Object.defineProperty(this,ht,{writable:!0,value:null}),Object.defineProperty(this,dt,{writable:!0,value:null}),Object.defineProperty(this,ft,{writable:!0,value:{value:null,curValue:null,pos:0,lengthLimitVisible:!0,zero:"0",decimal:".",minus:"-"}}),Object.defineProperty(this,pt,{writable:!0,value:{integer:"^[+-]?{digits}*$",decimal:"^[+-]?{digits}{leading}({decimal}{digits}{fraction})?$",float:"^[+-]?{digits}*({decimal}{digits}*)?$"}}),Object.defineProperty(this,vt,{writable:!0,value:null}),Object.defineProperty(this,mt,{writable:!0,value:null}),Object.defineProperty(this,gt,{writable:!0,value:null}),Object.defineProperty(this,yt,{writable:!0,value:!1}),Object.defineProperty(this,bt,{writable:!0,value:""}),l(this,ct)[ct]=e,l(this,ht)[ht]=t,l(this,dt)[dt]=Object.assign({},l(this,ft)[ft],l(this,ht)[ht]._jsonModel),l(this,pt)[pt][l(this,dt)[dt].dataType]){var n=l(this,dt)[dt].leadDigits,i=l(this,dt)[dt].fracDigits,r=i&&-1!==i?"{0,"+i+"}":"*",o=o.replace("{leading}",n&&-1!==n?"{0,"+n+"}":"*").replace("{fraction}",r),a=o.replace(/{digits}/g,l(this,Mt)[Mt]()).replace("{decimal}",l(this,jt)[jt](l(this,dt)[dt].decimal)),s=o.replace(/{digits}/g,"[0-9]").replace("{decimal}","\\.");l(this,mt)[mt]=!("[0123456789]"===l(this,Mt)[Mt]()&&"."===l(this,dt)[dt].decimal),l(this,vt)[vt]=new RegExp(a,"g"),l(this,gt)[gt]=new RegExp(s,"g")}l(this,ct)[ct].setAttribute("type","text"),l(this,wt)[wt](e)}var t=e.prototype;return t.getValue=function(e){return(e=l(this,_t)[_t](e)).length>0&&l(this,mt)[mt]&&!e.match(l(this,gt)[gt])?(l(this,yt)[yt]=!0,e=l(this,Nt)[Nt](e)):l(this,yt)[yt]=!1,e&&e.length>=l(this,dt)[dt].combCells&&(e=e.slice(0,l(this,dt)[dt].combCells)),l(this,bt)[bt]=e,e},t.trigger=function(e,t){if(!l(this,ct)[ct])return this;var n=e.split(".")[0];if(void 0!==document.body["on"+n])return l(this,ct)[ct].dispatchEvent(new Event(n)),this;var i=new CustomEvent(n,{detail:t||null});return l(this,ct)[ct].dispatchEvent(i),this},t.getHTMLSupportedAttr=function(e,t){try{return e[t]}catch(e){return}},t.isNonPrintableKey=function(e){return e&&!["MozPrintableKey","Divide","Multiply","Subtract","Add","Enter","Decimal","Spacebar","Del"].includes(e)&&1!==e.length},t.setValue=function(e){l(this,It)[It]()||(e&&l(this,yt)[yt]?l(this,ct)[ct].value=l(this,Pt)[Pt](e):l(this,ct)[ct].value=l(this,ht)[ht].value)},e}();function qt(e){return e.replace(/[\uff00-\uffef]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})}function Vt(e,t){var n=this;e.addEventListener("keydown",function(e){l(n,St)[St](e)}),e.addEventListener("keypress",function(e){l(n,Tt)[Tt](e)}),e.addEventListener("paste",function(e){l(n,Ot)[Ot](e)}),e.addEventListener("cut",function(e){l(n,Lt)[Lt](e)}),e.addEventListener("blur",function(e){l(n,ht)[ht].value=n.getValue(e.target.value)}),l(this,kt)[kt](e)}function $t(e){var t=!1,n=this,i=function(){var t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()};e.addEventListener("keyup",function(e){t&&(l(n,Dt)[Dt](e)&&i(),t=!1)}),e.addEventListener("compositionstart",function(e){}),e.addEventListener("compositionupdate",function(e){l(n,Dt)[Dt](e)&&i()}),e.addEventListener("compositionend",function(e){t=!0}),e.addEventListener("keydown",function(e){229!==e.which&&(t=!1)})}function At(){for(var e=l(this,dt)[dt].zero.charCodeAt(0),t="",n=0;n<10;n++)t+=String.fromCharCode(e+n);return"["+t+"]"}function Ft(e){return e.replace(".","\\.")}function Rt(e){var t=this,n=!1,i=l(t,dt)[dt].leadDigits,r=l(t,dt)[dt].fracDigits;if(-1!==i){var o=l(this,ct)[ct].value;"compositionupdate"===e.type&&e.originalEvent.data&&(o+=e.originalEvent.data.substr(e.originalEvent.data.length-1));var a=i+(-1!==r?r+l(t,dt)[dt].decimal.length:0);-1===o.indexOf(l(t,dt)[dt].decimal)&&(a=i);var s=l(this,_t)[_t](o),u=s.match(l(t,vt)[vt])||s.match(l(this,gt)[gt]);if(n=!u,null===u)l(t,ct)[ct].value=l(t,bt)[bt],n=!0;else if(n){var c=o.substr(0,a);l(t,ct)[ct].value=c,l(t,bt)[bt]=c,n=!0}else l(t,bt)[bt]=o}return n}function Bt(e,t,n){if(e.ctrlKey&&!["paste","cut"].includes(e.type))return!0;l(this,St)[St](arguments),l(this,dt)[dt].lengthLimitVisible=!0;var i,r=l(this,ct)[ct].value,o=this.getHTMLSupportedAttr(l(this,ct)[ct],"selectionStart")||0,a=!(null==o),s=this.getHTMLSupportedAttr(l(this,ct)[ct],"selectionEnd")||0,u=parseInt(l(this,dt)[dt].combCells)||0,c=t;if(u>0&&(c=t.substr(0,u-r.length+s-o)),!a)return!0;i=r.substr(0,o)+c+r.substr(s);var h=l(this,_t)[_t](i);return null==l(this,vt)[vt]||h.match(l(this,vt)[vt])||h.match(l(this,gt)[gt])?!["keydown","cut"].includes(e.type)&&u&&(r.length>=u||i.length>u)&&o===s?(e.preventDefault(),!1):(l(this,dt)[dt].curValue=r,l(this,bt)[bt]=r,void(l(this,dt)[dt].pos=o)):(e.preventDefault(),!1)}function Ht(e){if(e){var t=e.charCode||e.which||e.keyCode||0;if(8===t||46===t)l(this,Et)[Et](e,"",t);else if(32===t)return e.preventDefault(),!1}}function zt(e){e=l(this,_t)[_t](e);var t=String.fromCharCode(l(this,dt)[dt].zero.charCodeAt(0)+9);return e>="0"&&e<="9"||e>=l(this,dt)[dt].zero&&e<=t||e===l(this,dt)[dt].decimal||e===l(this,dt)[dt].minus}function Wt(e){if(e){var t=e.charCode||e.which||e.keyCode||0,n=String.fromCharCode(t);if(this.isNonPrintableKey(e.key))return!0;if(l(this,xt)[xt](n))l(this,Et)[Et](e,n,t);else if(!e.ctrlKey)return e.preventDefault(),!1}}function Ut(e){if(e){var t=void 0;if(window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):(e.originalEvent||e).clipboardData&&(e.originalEvent||e).clipboardData.getData&&(t=(e.originalEvent||e).clipboardData.getData("text/plain")),t)if(t.split("").every(function(e){return l(this,xt)[xt](e)},this))t=l(this,_t)[_t](t),l(this,Et)[Et](e,t,0);else if(!e.ctrlKey)return e.preventDefault(),!1}}function Qt(e){e&&l(this,Et)[Et](e,"",0)}function Gt(e){var t=l(this,dt)[dt].zero.charCodeAt(0);return e.map(function(e){return"."===e?l(this,dt)[dt].decimal:"-"===e?l(this,dt)[dt].minus:String.fromCharCode(parseInt(e)+t)},this).join("")}function Zt(e){e=l(this,_t)[_t](e);var t=l(this,dt)[dt].zero.charCodeAt(0);return e.map(function(e){return e===l(this,dt)[dt].decimal?".":e===l(this,dt)[dt].minus?"-":(e.charCodeAt(0)-t).toString()},this).join("")}function Jt(){return null===l(this,ht)[ht].value&&""===l(this,ct)[ct].value||l(this,ht)[ht].value===l(this,ct)[ct].value}var Kt=/*#__PURE__*/function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).widgetObject=void 0,t}r(t,e);var n=t.prototype;return n.getClass=function(){return t.IS},n.getWidget=function(){return this.element.querySelector(t.selectors.widget)},n.getDescription=function(){return this.element.querySelector(t.selectors.description)},n.getLabel=function(){return this.element.querySelector(t.selectors.label)},n.getErrorDiv=function(){return this.element.querySelector(t.selectors.errorDiv)},n.getTooltipDiv=function(){return this.element.querySelector(t.selectors.tooltipDiv)},n.getQuestionMarkDiv=function(){return this.element.querySelector(t.selectors.qm)},n._updateValue=function(t){null==this.widgetObject&&(this._model._jsonModel.editFormat||this._model._jsonModel.displayFormat)&&(this.widgetObject=new Ct(this.getWidget(),this._model)),this.widgetObject?this.widgetObject.setValue(t):e.prototype._updateValue.call(this,t)},n.addListener=function(){var e,t=this;this._model._jsonModel.editFormat||this._model._jsonModel.displayFormat?null==this.widgetObject&&(this.widgetObject=new Ct(this.getWidget(),this._model)):null==(e=this.getWidget())||e.addEventListener("blur",function(e){t._model.value=e.target.value})},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getInputHTML=function(){return'<input\n            class="cmp-adaptiveform-numberinput__widget"\n            title="'+(this.isTooltipVisible()?this.getTooltipValue():"")+'"\n            aria-label="'+(this.isLabelVisible()?this.getLabelValue():"")+'"\n            type="number"\n            name="'+this.getName()+'"\n            value="'+this.getDefault()+'"\n            max="'+this.getMaximum()+'"\n            min="'+this.getMinimum()+'"\n            '+this.getDisabledHTML()+"\n            "+this.getReadonlyHTML()+'\n            required="'+this.isRequired()+'"\n            placeholder="'+this.getPlaceHolder()+'"/>'},t}(h);Kt.NS="cmp",Kt.IS="adaptiveFormNumberInput",Kt.bemBlock="cmp-adaptiveform-numberinput",Kt.selectors={self:"[data-"+Kt.NS+'-is="'+Kt.IS+'"]',widget:"."+Kt.bemBlock+"__widget",label:"."+Kt.bemBlock+"__label",description:"."+Kt.bemBlock+"__longdescription",errorDiv:"."+Kt.bemBlock+"__errormessage",qm:"."+Kt.bemBlock+"__questionmark",tooltipDiv:"."+Kt.bemBlock+"__shortdescription"};var Yt=/*#__PURE__*/function(e){function t(n,i){var r;return(r=e.call(this,n,i)||this).qm=r.element.querySelector(t.selectors.qm),r}r(t,e);var n=t.prototype;return n.getWidget=function(){return this.element.querySelector(t.selectors.widget)},n.getWidgets=function(){return this.element.querySelectorAll(t.selectors.widget)},n.getDescription=function(){return this.element.querySelector(t.selectors.description)},n.getLabel=function(){return this.element.querySelector(t.selectors.label)},n.getQuestionMarkDiv=function(){return this.element.querySelector(t.selectors.qm)},n.getTooltipDiv=function(){return this.element.querySelector(t.selectors.tooltipDiv)},n.getErrorDiv=function(){return this.element.querySelector(t.selectors.errorDiv)},n._updateEnabled=function(e){this.toggle(e,"aria-disabled",!0),this.element.setAttribute("data-cmp-enabled",e+"");var t=this.getWidgets();null==t||t.forEach(function(t){!1===e?(t.setAttribute("disabled",!0+""),t.setAttribute("aria-disabled",!0+"")):(t.removeAttribute("disabled"),t.removeAttribute("aria-disabled"))})},n._updateValue=function(e){null!=e&&this.getWidgets().forEach(function(t){null!=t.value&&e.toString()==t.value.toString()?(t.checked=!0,t.setAttribute("checked","checked"),t.setAttribute("aria-checked",!0+"")):(t.checked=!1,t.removeAttribute("checked"),t.setAttribute("aria-checked",!1+""))},this)},n.addListener=function(){var e=this;this.getWidgets().forEach(function(t){t.addEventListener("change",function(t){e._model.value=t.target.value})})},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getInputHTML=function(){var e,t,n=this;return"\n            "+(null==(e=this.getState())||null==(t=e.enumNames)?void 0:t.map(function(e,t){var i;return n.getRadioHTML(n,null==(i=n.getState())?void 0:i.enum[t],e,t)}).join(""))},n.getRadioHTML=function(e,t,n,i){return'<div class="cmp-adaptiveform-radiobutton__option '+e.getLayoutProperties().orientation+'">\n                    <label class="cmp-adaptiveform-radiobutton__option__label"\n                            title="'+e.getTooltipValue()+'"\n                            aria-describedby="_desc"\n                            aria-label="'+n+'">\n                        <input type="radio"\n                                name="'+e.getName()+'"\n                                class="cmp-adaptiveform-radiobutton__option__widget"\n                                id="'+e.id+"_"+i+'__widget"\n                                value="'+t+'"\n                                '+this.getDisabledHTML()+'\n                                aria-describedby="_desc"\n                                checked="'+(t==this.getDefault())+'"/>\n                        <span>'+n+"</span>\n                    </label>\n                </div>\n            </div>"},t}(h);Yt.NS="cmp",Yt.IS="adaptiveFormRadioButton",Yt.bemBlock="cmp-adaptiveform-radiobutton",Yt.selectors={self:"[data-"+Yt.NS+'-is="'+Yt.IS+'"]',widget:"."+Yt.bemBlock+"__option__widget",label:"."+Yt.bemBlock+"__label",description:"."+Yt.bemBlock+"__longdescription",qm:"."+Yt.bemBlock+"__questionmark",errorDiv:"."+Yt.bemBlock+"__errormessage",tooltipDiv:"."+Yt.bemBlock+"__shortdescription"};var Xt=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.getWidget=function(){return null},n.getDescription=function(){return null},n.getLabel=function(){return null},n.getErrorDiv=function(){return null},n.getTooltipDiv=function(){return null},n.getQuestionMarkDiv=function(){return null},n.getClass=function(){return t.IS},n.setFocus=function(){this.setActive()},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getHTML=function(){return'\n        <div data-cmp-is="'+this.getIS()+'"\n            id="'+this.id+'"\n            data-cmp-adaptiveformcontainer-path="'+this.getFormContainerPath()+'"\n            data-cmp-visible="'+this.getDefault()+'"\n            class="cmp-adaptiveform-text">\n            <div class="cmp-adaptiveform-text__widget" tabindex="0">\n                '+this.getState().value+"\n            </div>\n        </div>"},t}(h);Xt.NS="cmp",Xt.IS="adaptiveFormText",Xt.bemBlock="cmp-adaptiveform-text",Xt.selectors={self:"[data-"+Xt.NS+'-is="'+Xt.IS+'"]'};var en=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.getWidget=function(){return this.element.querySelector(t.selectors.widget)},n.getDescription=function(){return this.element.querySelector(t.selectors.description)},n.getLabel=function(){return this.element.querySelector(t.selectors.label)},n.getErrorDiv=function(){return this.element.querySelector(t.selectors.errorDiv)},n.getTooltipDiv=function(){return this.element.querySelector(t.selectors.tooltipDiv)},n.getQuestionMarkDiv=function(){return this.element.querySelector(t.selectors.qm)},n.addListener=function(){var e,t,n=this;null==(e=this.getWidget())||e.addEventListener("blur",function(e){n._model.value=e.target.value,n.setInactive()}),null==(t=this.getWidget())||t.addEventListener("focus",function(e){n.setActive()})},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getInputHTML=function(){return'\n            <br>\n            <p class="range-info">'+this.getMinimum()+'</p>\n            <input\n                class="cmp-adaptiveform-SliderInput__widget"\n                title="'+(this.isTooltipVisible()?this.getTooltipValue():"")+'"\n                aria-label="'+(this.isLabelVisible()?this.getLabelValue():"")+'"\n                type="range"\n                name="'+this.getName()+'"\n                value="'+this.getDefault()+'"\n                step="'+this.getState().step+'"\n                '+this.getDisabledHTML()+"\n                "+this.getReadonlyHTML()+'\n                required="'+this.isRequired()+'"\n                placeholder="'+this.getPlaceHolder()+'"\n                min="'+this.getMinimum()+'"\n                max="'+this.getMaximum()+'"/>\n            \n            <p class="range-info">'+this.getMaximum()+"</p>\n            "},t}(h);en.NS="cmp",en.IS="adaptiveFormSliderInput",en.bemBlock="cmp-adaptiveform-sliderinput",en.selectors={self:"[data-"+en.NS+'-is="'+en.IS+'"]',widget:"."+en.bemBlock+"__widget",label:"."+en.bemBlock+"__label",description:"."+en.bemBlock+"__longdescription",qm:"."+en.bemBlock+"__questionmark",errorDiv:"."+en.bemBlock+"__errormessage",tooltipDiv:"."+en.bemBlock+"__shortdescription"};var tn=/*#__PURE__*/function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.getInputHTML=function(){return'<input\n              class="cmp-adaptiveform-textinput__widget"\n              title="'+(this.isTooltipVisible()?this.getTooltipValue():"")+'"\n              aria-label="'+(this.isLabelVisible()?this.getLabelValue():"")+'"\n              type="email"\n              name="'+this.getName()+'"\n              value="'+this.getDefault()+'"\n              '+this.getDisabledHTML()+"\n              "+this.getReadonlyHTML()+'\n              required="'+this.isRequired()+'"\n              placeholder="'+this.getPlaceHolder()+'"\n              minlength="'+this.getMinLength()+'"\n              maxlength="'+this.getMaxLength()+'"/>'},t}(d),nn=/*#__PURE__*/function(e){function t(n,i){var r;return(r=e.call(this,n,i)||this).widgetLabel=void 0,r.qm=r.element.querySelector(t.selectors.qm),r.widgetLabel=r.element.querySelector(t.selectors.widgetLabel),r}r(t,e);var n=t.prototype;return n.getWidget=function(){return this.element.querySelector(t.selectors.widget)},n.getWidgets=function(){return this.element.querySelectorAll(t.selectors.widget)},n.getDescription=function(){return this.element.querySelector(t.selectors.description)},n.getLabel=function(){return this.element.querySelector(t.selectors.label)},n.getErrorDiv=function(){return this.element.querySelector(t.selectors.errorDiv)},n.getQuestionMarkDiv=function(){return this.element.querySelector(t.selectors.qm)},n.getTooltipDiv=function(){return this.element.querySelector(t.selectors.tooltipDiv)},n._updateModelValue=function(){var e=[],t=this.getWidgets();null==t||t.forEach(function(t){t.checked&&e.push(t.value)},this),this._model.value=e},n._updateEnabled=function(e){this.toggle(e,"aria-disabled",!0),this.element.setAttribute("data-cmp-enabled",e+"");var t=this.getWidgets();null==t||t.forEach(function(t){!1===e?(t.setAttribute("disabled",!0+""),t.setAttribute("aria-disabled",!0+"")):(t.removeAttribute("disabled"),t.removeAttribute("aria-disabled"))})},n._updateValue=function(e){var t=(e=[].concat(e)).map(String),n=this.getWidgets();null==n||n.forEach(function(e){t.includes(e.value)?(e.checked=!0,e.setAttribute("checked","checked"),e.setAttribute("aria-checked",!0+"")):(e.checked=!1,e.removeAttribute("checked"),e.setAttribute("aria-checked",!1+""))},this)},n.getEnums=function(){return this.getState().enums},n.getEnumNames=function(){return this.getState().enumNames},n.addListener=function(){var e=this;this.getWidgets().forEach(function(t){t.addEventListener("change",function(t){e._updateModelValue()})})},n.getbemBlock=function(){return t.bemBlock},n.getIS=function(){return t.IS},n.getInputHTML=function(){var e,t=this;return'\n            <div class="cmp-adaptiveform-checkboxgroup__widget">\n            '+(null==(e=this.getEnumNames())?void 0:e.map(function(e,n){var i;return t.getCheckboxHTML(t,null==(i=t.getState())?void 0:i.enum[n],e,n)}).join(""))+"\n            </div>\n            "},n.getCheckboxHTML=function(e,t,n,i){return'<div class="cmp-adaptiveform-checkboxgroup-item '+e.getName+" "+e.getLayoutProperties().orientation+' ">\n            <label class="cmp-adaptiveform-checkbox__label" aria-label="'+e.getEnumNames()[i]+'"\n                title="'+e.getTooltipValue()+'"\n                for="'+e.id+"_"+i+'__widget">\n                <input class="cmp-adaptiveform-checkbox__widget" type="checkbox" id="'+e.id+"_"+i+'__widget"\n                    aria-describedby="_desc"\n                    name="'+e.getName()+'"\n                    value="'+e.getState().enums[i].toString+'"\n                    checked="'+(e.getEnums()[i]==e.getDefault())+'"\n                    '+this.getDisabledHTML()+" />\n                <span>"+e.getEnumNames()[i]+"</span>\n            </label>\n        </div>"},t}(h);nn.NS="cmp",nn.IS="adaptiveFormCheckBoxGroup",nn.bemBlock="cmp-adaptiveform-checkboxgroup",nn.checkboxBemBlock="cmp-adaptiveform-checkbox",nn.selectors={self:"[data-"+nn.NS+'-is="'+nn.IS+'"]',widgets:"."+nn.bemBlock+"__widgets",widget:"."+nn.checkboxBemBlock+"__widget",widgetLabel:"."+nn.checkboxBemBlock+"__label",label:"."+nn.bemBlock+"__label",description:"."+nn.bemBlock+"__longdescription",qm:"."+nn.bemBlock+"__questionmark",errorDiv:"."+nn.bemBlock+"__errormessage",tooltipDiv:"."+nn.bemBlock+"__shortdescription"};var rn=/*#__PURE__*/function(){function e(e){var t=this;this._model=void 0,this._path=void 0,this._fields=void 0,this._deferredParents=void 0,this.renderChildrens=function(e,n){console.log("Rendering childrens");var i=null==n?void 0:n.items;i&&i.length>0&&i.forEach(function(n){e.append(t.getRender(n))})},this.getRender=function(e){var n=document.createElement("div");try{var i,r=t.getModel(e.id),o={element:n,id:e.id};switch(null==e?void 0:e.fieldType){case"checkbox":i=new nn(o,r);break;case"email":i=new tn(o,r);break;case"slider":i=new en(o,r);break;case"plain-text":i=new Xt(o,r);break;case"radio":i=new Yt(o,r);break;case"number":i=new Kt(o,r);break;case"button":i=new lt(o,r);break;case"select":i=new st(o,r);break;case"text-area":i=new ot(o,r);break;default:i=new d(o,r)}i&&i.render()}catch(e){console.error("Unexpected error ",e)}return n},this._model=function(e,t,n,i){void 0===n&&(n="error"),void 0===i&&(i=void 0);try{var r=i;null==r&&(r=new it(w({},e),new rt,new Je(new Ge(n)),n));var o=null==e?void 0:e.data;return o&&r.importData(o),r.getEventQueue().runPendingQueue(),r}catch(e){throw console.error("Unable to create an instance of the Form "+e),new Error(e)}}(i({},e._formJson)),this._path=e._path,this._fields={},this._deferredParents={}}var t=e.prototype;return t.getField=function(e){return this._fields.hasOwnProperty(e)?this._fields[e]:null},t.getModel=function(e){return e?this._model.getElement(e):this._model},t.addField=function(e){if(e.getFormContainerPath()===this._path){var t=e.getId();this._fields[t]=e;var n=this.getModel(t);e.setModel(n);var i=n.parent.id;if("$form"!=i){var r=this._fields[i];r?e.setParent(r):(this._deferredParents[i]||(this._deferredParents[i]=[]),this._deferredParents[i].push(e))}if(this._deferredParents[t]){for(var o=this._deferredParents[t],a=0;a<o.length;a++)o[a].setParent(e);delete this._deferredParents[t]}e.subscribe()}},t.setFocus=function(e){if(e){var t=this._fields[e];t&&t.setFocus?t.setFocus():console.log("View on which focus is to be set, not initialized.")}},t.getPath=function(){return this._path},t.render=function(){var e=document.createElement("form");e.className="cmp-adaptiveform-container cmp-container";var t=this._model.getState();return this.renderChildrens(e,t),e},e}(),on=/*#__PURE__*/u("handlePanel"),an=/*#__PURE__*/u("handleProperty"),sn=/*#__PURE__*/u("setProperty"),un=/*#__PURE__*/u("handleMultiValues"),ln=/*#__PURE__*/u("handleHierarchy"),cn=/*#__PURE__*/u("isRule"),hn=/*#__PURE__*/u("isConstraintMsg"),dn=/*#__PURE__*/u("isPanel"),fn=/*#__PURE__*/u("isEndingPanel"),pn=/*#__PURE__*/u("cleanUpPanel"),vn=/*#__PURE__*/function(){function e(){Object.defineProperty(this,pn,{value:Dn}),Object.defineProperty(this,fn,{value:jn}),Object.defineProperty(this,dn,{value:Mn}),Object.defineProperty(this,hn,{value:kn}),Object.defineProperty(this,cn,{value:wn}),Object.defineProperty(this,ln,{value:_n}),Object.defineProperty(this,un,{value:bn}),Object.defineProperty(this,sn,{value:yn}),Object.defineProperty(this,an,{value:gn}),Object.defineProperty(this,on,{value:mn})}var t=e.prototype;return t._getForm=function(e){try{if(!e)throw new Error("form name is required");return Promise.resolve(fetch(e)).then(function(e){return Promise.resolve(e.json()).then(function(e){return console.log("Data",e),e})})}catch(e){return Promise.reject(e)}},t.getFormModel=function(e){try{var t=this;return Promise.resolve(function(){if(e){var n={adaptiveform:"0.10.0",metadata:{grammar:"json-formula-1.0.0",version:"1.0.0"},items:[]};return Promise.resolve(t._getForm(e)).then(function(i){if(!i||!i.data)throw new Error("Unable to retrieve the form details with excel name "+e);var r=[];r.push(n.items);var o=n;return i.data.forEach(function(e){if(l(t,dn)[dn](e)){e.items={};var i=JSON.parse(JSON.stringify(e));l(t,on)[on](i),o.items.push(i),r.push(o),o=i}else l(t,fn)[fn](e)?(o=r.pop())||(o=n):o.items.push(l(t,an)[an](e))}),{formDef:n,excelData:i}})}}())}catch(e){return Promise.reject(e)}},e}();function mn(e){if(l(this,pn)[pn](e),l(this,cn)[cn](e)){var t=l(this,ln)[ln](e,"Rules.");t&&0!=Object.keys(t).length&&(e.rules=t)}var n=l(this,ln)[ln](e,"events.");n&&0!=Object.keys(n).length&&(e.events=n)}function gn(e){var t=Object.fromEntries(Object.entries(e).filter(function(e){var t=e[1];return null!=t&&""!=t})),n=vn.fieldMapping.has(t.Type)?vn.fieldMapping.get(t.Type):t.Type,i={name:t.Field,placeholder:t.Placeholder,type:"string",fieldType:n,value:t.Value,label:{value:t.Label},required:!!t.Mandatory};if(l(this,sn)[sn](t,"Maximum",i,"maximum"),l(this,sn)[sn](t,"Minimum",i,"minimum"),l(this,sn)[sn](t,"MaxLength",i,"maxLength"),l(this,sn)[sn](t,"MinLength",i,"minLength"),l(this,sn)[sn](t,"Step",i,"step"),l(this,cn)[cn](t)){var r=l(this,ln)[ln](t,"Rules.");r&&0!=Object.keys(r).length&&(i.rules=r)}if(l(this,hn)[hn](t)){var o=l(this,ln)[ln](t,"constraintMessages.");o&&0!=Object.keys(o).length&&(i.constraintMessages=o)}var a=l(this,ln)[ln](t,"events.");a&&0!=Object.keys(a).length&&(i.events=a);var s=l(this,un)[un](t,"Options");return s&&(i.enumNames=i.enum=s),i}function yn(e,t,n,i){e&&e[t]&&(n[i]=e[t])}function bn(e,t){var n;return e&&e[t]&&(n=e[t].split(",").map(function(e){return e.trim()})),n}function _n(e,t){var n={};return Object.keys(e).forEach(function(i){if(~i.indexOf(t)){var r=i.split(".")[1];e[i]&&(n[r]=e[i]),delete e[i]}}),n}function wn(e){return Object.keys(e).some(function(e){return~e.indexOf("Rules.")})}function kn(e){return Object.keys(e).some(function(e){return~e.indexOf("constraintMessages.")})}function Mn(e){return e&&"object"==e.type}function jn(e){return e&&"page-break"==e.viewType}function Dn(e){delete e.type}vn.fieldMapping=new Map([["text-input","text"],["number-input","number"],["date-input","datetime-local"],["file-input","file"],["drop-down","select"],["radio-group",""],["checkbox-group",""],["plain-text","plain-text"],["checkbox","checkbox"],["multiline-input","text-area"],["panel","panel"],["submit","button"]]);var En=function(e){try{var t=e.querySelector('a[href$=".json"]'),n=function(){if(t&&null!=t&&t.href){var e=t.replaceWith;return Promise.resolve(Sn(t.href)).then(function(n){e.call(t,n)})}}();return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},Sn=function(e){try{console.log("Loading & Converting excel form to Crispr Form");var t=new vn;return Promise.resolve(t.getFormModel(e)).then(function(e){console.log(e),console.log("Creating Form Container");var t=new rn({_formJson:null==e?void 0:e.formDef});return window.guideContainer=t,t.render()})}catch(e){return Promise.reject(e)}};En(document.getElementsByClassName("form")[0]);export{En as default};