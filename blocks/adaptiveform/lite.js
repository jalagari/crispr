function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},e.apply(this,arguments)}var t=0;function i(e){return"__private_"+t+++"_"+e}function r(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}class s{constructor(e,t){this.formContainer=void 0,this.element=void 0,this.active=void 0,this.id=void 0,this.parentView=void 0,this._model=void 0,this.state=void 0,this.options=void 0,this.fullVersion=!1,this.formContainer=e.formContainer,this.id=e.id,this.element=e.element,this.active=!1,this.setModel(t)}setId(e){this.id=e}setParent(e){this.parentView=e,this.parentView.addChild&&this.parentView.addChild(this)}setActive(){this.isActive()||this.element.setAttribute("data-cmp-active","true"),this.parentView&&this.parentView.setActive&&this.parentView.setActive()}setInactive(){this.isActive()&&this.element.setAttribute("data-cmp-active","false"),this.parentView&&this.parentView.setInactive&&this.parentView.setInactive()}isActive(){return this.active}getFormContainerPath(){var e;return null==(e=this.options)?void 0:e.adaptiveformcontainerPath}getId(){return this.id}setModel(e){var t,i;if(null!=this._model)throw"Re-initializing model is not permitted";this._model=e,"function"==typeof(null==(t=this._model)?void 0:t.getState)?(this.state=null==(i=this._model)?void 0:i.getState(),this.fullVersion=!0):this.state=this._model}toggle(e,t,i){this.toggleAttribute(this.element,e,t,i)}toggleAttribute(e,t,i,r){e&&(!1===t?e.setAttribute(i,r):e.removeAttribute(i))}getLayoutProperties(){let e={};const t=this.state;return t&&t.properties&&t.properties["afs:layout"]&&(e=t.properties["afs:layout"]),e}getModel(){return this._model}subscribe(){throw"the field does not subscribe to the model"}isVisible(){var e;return(null==this||null==(e=this.state)?void 0:e.visible)||!0}isEnabled(){var e;return(null==this||null==(e=this.state)?void 0:e.enabled)||!0}isLabelVisible(){var e,t;return(null==this||null==(e=this.state)||null==(t=e.label)?void 0:t.visible)||!0}getLabelValue(){var e,t;return(null==this||null==(e=this.state)||null==(t=e.label)?void 0:t.value)||""}getName(){var e;return(null==this||null==(e=this.state)?void 0:e.name)||""}isTooltipVisible(){return!1}getTooltipValue(){return""}isShortDescVisible(){return!1}getShortDescValue(){return""}getDescriptionValue(){var e;return(null==this||null==(e=this.state)?void 0:e.description)||""}getDefault(){var e;return(null==this||null==(e=this.state)?void 0:e.default)||""}isReadOnly(){var e;return(null==this||null==(e=this.state)?void 0:e.readOnly)||!1}isRequired(){var e;return(null==this||null==(e=this.state)?void 0:e.required)||!1}getPlaceHolder(){var e;return(null==this||null==(e=this.state)?void 0:e.placeholder)||""}getMinLength(){var e;return null==this||null==(e=this.state)?void 0:e.minLength}getMaxLength(){var e;return null==this||null==(e=this.state)?void 0:e.maxLength}getMinimum(){var e;return null==this||null==(e=this.state)?void 0:e.minimum}getMaximum(){var e;return null==this||null==(e=this.state)?void 0:e.maximum}getEnum(){var e;return null==(e=this.state)?void 0:e.enum}getEnumNames(){var e;return null==(e=this.state)?void 0:e.enumNames}}s.IS="FormField";class l extends s{constructor(e,t){super(e,t),this.qm=void 0,this.widget=void 0,this.label=void 0,this.errorDiv=void 0,this.tooltip=void 0,this.description=void 0,this.element.className=this.getbemBlock(),this.widget=this.getWidget(),this.description=this.getDescription(),this.label=this.getLabel(),this.errorDiv=this.getErrorDiv(),this.qm=this.getQuestionMarkDiv(),this.tooltip=this.getTooltipDiv()}getWidget(){throw"method not implemented"}getDescription(){throw"method not implemented"}getLabel(){throw"method not implemented"}getErrorDiv(){throw"method not implemented"}getTooltipDiv(){throw"method not implemented"}getQuestionMarkDiv(){throw"method not implemented"}setModel(e){super.setModel(e)}setFocus(){var e;null==(e=this.getWidget())||e.focus()}_applyState(e){e.value&&this._updateValue(e.value),this._updateVisible(e.visible),this._updateEnabled(e.enabled),this._initializeHelpContent(e)}_initializeHelpContent(e){this._showHideLongDescriptionDiv(!1),this.getDescription()&&this._addHelpIconHandler(e)}_showHideTooltipDiv(e){this.tooltip&&this.toggleAttribute(this.getTooltipDiv(),e,"data-cmp-visible",!1)}_showHideLongDescriptionDiv(e){this.description&&this.toggleAttribute(this.description,e,"data-cmp-visible",!1)}_isTooltipAlwaysVisible(){return!!this.getLayoutProperties().tooltipVisible}_updateVisible(e){this.toggle(e,"aria-hidden",!0),this.element.setAttribute("data-cmp-visible",e+"")}_updateEnabled(e){var t,i,r,s;this.getWidget()&&(this.toggle(e,"aria-disabled",!0),this.element.setAttribute("data-cmp-enabled",e+""),!1===e?(null==(t=this.getWidget())||t.setAttribute("disabled","true"),null==(i=this.getWidget())||i.setAttribute("aria-disabled","true")):(null==(r=this.getWidget())||r.removeAttribute("disabled"),null==(s=this.getWidget())||s.removeAttribute("aria-disabled")))}_updateValid(e,t){this.errorDiv&&(this.toggle(e,"aria-invalid",!0),this.element.setAttribute("data-cmp-valid",e+""),"string"!=typeof t.errorMessage||""===t.errorMessage)&&(this.errorDiv.innerHTML=!0===e?"":"There is an error in the field")}_updateErrorMessage(e,t){this.errorDiv&&(this.errorDiv.innerHTML=t.errorMessage)}_updateValue(e){let t=this.getWidget();t&&(t.value=e)}_addHelpIconHandler(e){const t=this.qm,i=this.description,r=this._isTooltipAlwaysVisible(),s=this;t&&i&&t.addEventListener("click",e=>{e.preventDefault(),"false"===i.getAttribute("data-cmp-visible")?(s._showHideLongDescriptionDiv(!0),r&&s._showHideTooltipDiv(!1)):(s._showHideLongDescriptionDiv(!1),r&&s._showHideTooltipDiv(!0))})}getClass(){return this.constructor.IS}subscribe(){var e;null==(e=this._model)||e.subscribe(e=>{let t=e.target.getState();e.payload.changes.forEach(e=>{const i=`_update${(r=e.propertyName)[0].toUpperCase()+r.slice(1)}`;var r;"function"==typeof this[i]?"items"===e.propertyName?this[i](e.prevValue,e.currentValue,t):this[i](e.currentValue,t):console.error(`changes to ${e.propertyName} are not supported. Please raise an issue`)})})}getbemBlock(){throw"bemBlock not implemented"}getIS(){throw"IS is not implemented"}getId(){return this.getIS()+"-"+this.id}addListener(){}render(){this.element.appendChild(this.createView()),this.fullVersion&&(this.addListener(),this.subscribe())}createView(){var e,t;let i=document.createElement("div");i.id=this.getId(),i.dataset.cmpVisible=null==(e=this.isVisible())?void 0:e.toString(),i.dataset.cmpEnabled=null==(t=this.isEnabled())?void 0:t.toString(),i.dataset.cmpAdaptiveformcontainerPath=this.getFormContainerPath(),this.isLabelVisible()&&i.appendChild(this.createLabel());let r=this.createInputHTML();return r&&(r instanceof Element?i.appendChild(r):r instanceof Array&&(null==r||r.forEach(e=>{i.appendChild(e)}))),this.getDescriptionValue()&&(i.appendChild(this.createQuestionMarkHTML()),i.appendChild(this.createLongDescHTML())),this.isShortDescVisible()&&i.appendChild(this.createShortDescHTML()),i.appendChild(this.createErrorHTML()),i}createInputHTML(){throw"getInputHTML is not implemented"}createLabel(){let e=document.createElement("label");return e.id=this.getId()+"-label",e.htmlFor=this.getId(),e.className=this.getbemBlock()+"__label",e.textContent=this.getLabelValue(),e}createQuestionMarkHTML(){let e=document.createElement("button");return e.className=this.getbemBlock()+"__questionmark",e}createShortDescHTML(){let e=document.createElement("div");return e.id=this.getId()+"-shortDescription",e.className=this.getbemBlock()+"__shortdescription",e}createLongDescHTML(){let e=document.createElement("div");return e.setAttribute("aria-live","polite"),e.id=this.getId()+"-longDescription",e.className=this.getbemBlock()+"__longdescription",e}createErrorHTML(){let e=document.createElement("div");return e.id=this.getId()+"-errorMessage",e.className=this.getbemBlock()+"__errormessage",e}setDisabledAttribute(e){e.disabled=!this.isEnabled()}setReadonlyAttribute(e){e.disabled=this.isReadOnly()}setStringContraints(e){var t;let i=this.getMaxLength(),r=this.getMinLength();r>0&&(e.minLength=r),r>0&&(e.maxLength=i),e instanceof HTMLInputElement&&(e.pattern=null==(t=this.state)?void 0:t.pattern)}setNumberConstraints(e){let t=this.getMaximum(),i=this.getMinimum();t>0&&(e.max=null==t?void 0:t.toString()),i>0&&(e.min=null==i?void 0:i.toString())}}class n extends l{getWidget(){return this.element.querySelector(n.selectors.widget)}getDescription(){return this.element.querySelector(n.selectors.description)}getLabel(){return this.element.querySelector(n.selectors.label)}getErrorDiv(){return this.element.querySelector(n.selectors.errorDiv)}getTooltipDiv(){return this.element.querySelector(n.selectors.tooltipDiv)}getQuestionMarkDiv(){return this.element.querySelector(n.selectors.qm)}addListener(){var e,t;null==(e=this.getWidget())||e.addEventListener("blur",e=>{this._model.value=e.target.value,this.setInactive()}),null==(t=this.getWidget())||t.addEventListener("focus",e=>{this.setActive()})}getbemBlock(){return n.bemBlock}getIS(){return n.IS}createInputHTML(){let e=document.createElement("input");return e.type="text",e.className="cmp-adaptiveform-textinput__widget",e.title=this.isTooltipVisible()?this.getTooltipValue():"",e.name=this.getName(),e.value=this.getDefault(),e.placeholder=this.getPlaceHolder(),e.required=this.isRequired(),e.setAttribute("aria-label",this.isLabelVisible()?this.getLabelValue():""),this.setDisabledAttribute(e),this.setReadonlyAttribute(e),this.setStringContraints(e),e}}n.NS="cmp",n.IS="adaptiveFormTextInput",n.bemBlock="cmp-adaptiveform-textinput",n.selectors={self:"[data-"+n.NS+'-is="'+n.IS+'"]',widget:`.${n.bemBlock}__widget`,label:`.${n.bemBlock}__label`,description:`.${n.bemBlock}__longdescription`,qm:`.${n.bemBlock}__questionmark`,errorDiv:`.${n.bemBlock}__errormessage`,tooltipDiv:`.${n.bemBlock}__shortdescription`};class a extends n{createInputHTML(){let e=document.createElement("textarea");return e.className="cmp-adaptiveform-textarea__widget",e.title=this.isTooltipVisible()?this.getTooltipValue():"",e.name=this.getName(),e.value=this.getDefault(),e.placeholder=this.getPlaceHolder(),e.required=this.isRequired(),e.setAttribute("aria-label",this.isLabelVisible()?this.getLabelValue():""),this.setDisabledAttribute(e),this.setReadonlyAttribute(e),this.setStringContraints(e),e}}var o=/*#__PURE__*/i("checkIfEqual");class d extends l{constructor(e,t){super(e,t),Object.defineProperty(this,o,{writable:!0,value:function(e,t,i){if(i){let i=!1;return e.forEach(e=>{String(e)===t&&(i=!0)}),i}return String(e)===t}}),this.qm=this.element.querySelector(d.selectors.qm)}getWidget(){return this.element.querySelector(d.selectors.widget)}getDescription(){return this.element.querySelector(d.selectors.description)}getLabel(){return this.element.querySelector(d.selectors.label)}getErrorDiv(){return this.element.querySelector(d.selectors.errorDiv)}getQuestionMarkDiv(){return this.element.querySelector(d.selectors.qm)}getTooltipDiv(){return this.element.querySelector(d.selectors.tooltipDiv)}_updateValue(e){let t=this._model.isArrayType();this.widget&&[this.widget].forEach(i=>{r(this,o)[o](e,i.value,t)?i.setAttribute("selected","selected"):i.removeAttribute("selected")})}addListener(){var e;null==(e=this.getWidget())||e.addEventListener("blur",e=>{if(this._model.isArrayType()){let e=[];[this.widget].forEach(t=>{t.selected&&e.push(t.value)}),this._model.value=e}else this._model.value=e.target.value})}getbemBlock(){return d.bemBlock}getIS(){return d.IS}createInputHTML(){var e,t;let i=document.createElement("select");if(i.className="cmp-adaptiveform-dropdown__widget",i.title=this.isTooltipVisible()?this.getTooltipValue():"",i.name=this.getName(),i.multiple=null==(e=this.state)?void 0:e.isMultiSelect,i.required=this.isRequired(),i.setAttribute("aria-label",this.isLabelVisible()?this.getLabelValue():""),this.setDisabledAttribute(i),this.setReadonlyAttribute(i),this.getPlaceHolder()){let e=this.createOptions("",this.getPlaceHolder(),!0,!0);i.appendChild(e)}return null==(t=this.getEnum())||t.forEach((e,t)=>{i.appendChild(this.createOptions(e,this.getEnumNames()[t],e==this.getDefault(),!1))}),i}createOptions(e,t,i,r=!1){let s=document.createElement("option");return s.value=e,s.disabled=r,s.textContent=t,s.selected=i,s.className="cmp-adaptiveform-dropdown__option",s}}d.NS="cmp",d.IS="adaptiveFormDropDown",d.bemBlock="cmp-adaptiveform-dropdown",d.selectors={self:"[data-"+d.NS+'-is="'+d.IS+'"]',widget:`.${d.bemBlock}__widget`,options:`.${d.bemBlock}__option`,label:`.${d.bemBlock}__label`,description:`.${d.bemBlock}__longdescription`,qm:`.${d.bemBlock}__questionmark`,errorDiv:`.${d.bemBlock}__errormessage`,tooltipDiv:`.${d.bemBlock}__shortdescription`};class u extends l{getQuestionMarkDiv(){return null}getLabel(){return null}getWidget(){return this.element.querySelector(".cmp-button")}getDescription(){return null}getErrorDiv(){return null}getTooltipDiv(){return null}addListener(){var e;null==(e=this.getWidget())||e.addEventListener("click",()=>{import("./afcore.js").then(e=>{this._model.dispatch(new e.Click)})})}getbemBlock(){return u.bemBlock}getIS(){return u.IS}createView(){let e=document.createElement("button");e.type="button",e.id=this.getId(),e.className="cmp-button",e.title=this.getTooltipValue(),e.dataset.cmpVisible=this.isVisible().toString(),e.dataset.cmpEnabled=this.isEnabled().toString(),e.dataset.cmpAdaptiveformcontainerPath=this.getFormContainerPath(),e.dataset.cmpIs="adaptiveFormButton",e.setAttribute("aria-label",this.getLabelValue());let t=document.createElement("span");return t.className="cmp-button__text",t.textContent=this.getLabelValue(),e.appendChild(t),e}}u.NS="cmp",u.IS="adaptiveFormButton",u.bemBlock="cmp-adaptiveform-button",u.selectors={self:"[data-"+u.NS+'-is="'+u.IS+'"]'};var c=/*#__PURE__*/i("widget"),h=/*#__PURE__*/i("model"),m=/*#__PURE__*/i("options"),p=/*#__PURE__*/i("defaultOptions"),g=/*#__PURE__*/i("matchArray"),b=/*#__PURE__*/i("regex"),v=/*#__PURE__*/i("processedValue"),f=/*#__PURE__*/i("engRegex"),_=/*#__PURE__*/i("writtenInLocale"),y=/*#__PURE__*/i("previousCompositionVal"),w=/*#__PURE__*/i("toLatinForm"),k=/*#__PURE__*/i("attachEventHandlers"),S=/*#__PURE__*/i("attachCompositionEventHandlers"),D=/*#__PURE__*/i("getDigits"),E=/*#__PURE__*/i("escape"),L=/*#__PURE__*/i("compositionUpdateCallback"),V=/*#__PURE__*/i("handleKeyInput"),A=/*#__PURE__*/i("handleKeyDown"),C=/*#__PURE__*/i("isValidChar"),q=/*#__PURE__*/i("handleKeyPress"),M=/*#__PURE__*/i("handlePaste"),x=/*#__PURE__*/i("handleCut"),I=/*#__PURE__*/i("convertValueToLocale"),B=/*#__PURE__*/i("convertValueFromLocale"),O=/*#__PURE__*/i("isValueSame");class P{constructor(e,t){if(Object.defineProperty(this,O,{value:X}),Object.defineProperty(this,B,{value:G}),Object.defineProperty(this,I,{value:U}),Object.defineProperty(this,x,{value:K}),Object.defineProperty(this,M,{value:J}),Object.defineProperty(this,q,{value:z}),Object.defineProperty(this,C,{value:Q}),Object.defineProperty(this,A,{value:R}),Object.defineProperty(this,V,{value:W}),Object.defineProperty(this,L,{value:F}),Object.defineProperty(this,E,{value:$}),Object.defineProperty(this,D,{value:H}),Object.defineProperty(this,S,{value:N}),Object.defineProperty(this,k,{value:j}),Object.defineProperty(this,w,{value:T}),Object.defineProperty(this,c,{writable:!0,value:null}),Object.defineProperty(this,h,{writable:!0,value:null}),Object.defineProperty(this,m,{writable:!0,value:null}),Object.defineProperty(this,p,{writable:!0,value:{value:null,curValue:null,pos:0,lengthLimitVisible:!0,zero:"0",decimal:".",minus:"-"}}),Object.defineProperty(this,g,{writable:!0,value:{integer:"^[+-]?{digits}*$",decimal:"^[+-]?{digits}{leading}({decimal}{digits}{fraction})?$",float:"^[+-]?{digits}*({decimal}{digits}*)?$"}}),Object.defineProperty(this,b,{writable:!0,value:null}),Object.defineProperty(this,v,{writable:!0,value:null}),Object.defineProperty(this,f,{writable:!0,value:null}),Object.defineProperty(this,_,{writable:!0,value:!1}),Object.defineProperty(this,y,{writable:!0,value:""}),r(this,c)[c]=e,r(this,h)[h]=t,r(this,m)[m]=Object.assign({},r(this,p)[p],r(this,h)[h]._jsonModel),r(this,g)[g][r(this,m)[m].dataType]){let e=r(this,m)[m].leadDigits,t=r(this,m)[m].fracDigits,i=t&&-1!==t?"{0,"+t+"}":"*",s=s.replace("{leading}",e&&-1!==e?"{0,"+e+"}":"*").replace("{fraction}",i),l=s.replace(/{digits}/g,r(this,D)[D]()).replace("{decimal}",r(this,E)[E](r(this,m)[m].decimal)),n=s.replace(/{digits}/g,"[0-9]").replace("{decimal}","\\.");r(this,v)[v]=!("[0123456789]"===r(this,D)[D]()&&"."===r(this,m)[m].decimal),r(this,b)[b]=new RegExp(l,"g"),r(this,f)[f]=new RegExp(n,"g")}r(this,c)[c].setAttribute("type","text"),r(this,k)[k](e)}getValue(e){return(e=r(this,w)[w](e)).length>0&&r(this,v)[v]&&!e.match(r(this,f)[f])?(r(this,_)[_]=!0,e=r(this,B)[B](e)):r(this,_)[_]=!1,e&&e.length>=r(this,m)[m].combCells&&(e=e.slice(0,r(this,m)[m].combCells)),r(this,y)[y]=e,e}trigger(e,t){if(!r(this,c)[c])return this;const i=e.split(".")[0];if(void 0!==document.body[`on${i}`])return r(this,c)[c].dispatchEvent(new Event(i)),this;const s=new CustomEvent(i,{detail:t||null});return r(this,c)[c].dispatchEvent(s),this}getHTMLSupportedAttr(e,t){try{return e[t]}catch(e){return}}isNonPrintableKey(e){return e&&!["MozPrintableKey","Divide","Multiply","Subtract","Add","Enter","Decimal","Spacebar","Del"].includes(e)&&1!==e.length}setValue(e){r(this,O)[O]()||(e&&r(this,_)[_]?r(this,c)[c].value=r(this,I)[I](e):r(this,c)[c].value=r(this,h)[h].value)}}function T(e){return e.replace(/[\uff00-\uffef]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})}function j(e,t){e.addEventListener("keydown",e=>{r(this,A)[A](e)}),e.addEventListener("keypress",e=>{r(this,q)[q](e)}),e.addEventListener("paste",e=>{r(this,M)[M](e)}),e.addEventListener("cut",e=>{r(this,x)[x](e)}),e.addEventListener("blur",e=>{r(this,h)[h].value=this.getValue(e.target.value)}),r(this,S)[S](e)}function N(e){let t=!1,i=this,s=function(){let t=window.getSelection();t.selectAllChildren(e),t.collapseToEnd()};e.addEventListener("keyup",function(e){t&&(r(i,L)[L](e)&&s(),t=!1)}),e.addEventListener("compositionstart",function(e){}),e.addEventListener("compositionupdate",function(e){r(i,L)[L](e)&&s()}),e.addEventListener("compositionend",function(e){t=!0}),e.addEventListener("keydown",function(e){229!==e.which&&(t=!1)})}function H(){let e=r(this,m)[m].zero.charCodeAt(0),t="";for(let i=0;i<10;i++)t+=String.fromCharCode(e+i);return"["+t+"]"}function $(e){return e.replace(".","\\.")}function F(e){let t=this,i=!1,s=r(t,m)[m].leadDigits,l=r(t,m)[m].fracDigits;if(-1!==s){let n=r(this,c)[c].value;"compositionupdate"===e.type&&e.originalEvent.data&&(n+=e.originalEvent.data.substr(e.originalEvent.data.length-1));let a=s+(-1!==l?l+r(t,m)[m].decimal.length:0);-1===n.indexOf(r(t,m)[m].decimal)&&(a=s);let o=r(this,w)[w](n),d=o.match(r(t,b)[b])||o.match(r(this,f)[f]);if(i=!d,null===d)r(t,c)[c].value=r(t,y)[y],i=!0;else if(i){let e=n.substr(0,a);r(t,c)[c].value=e,r(t,y)[y]=e,i=!0}else r(t,y)[y]=n}return i}function W(e,t,i){if(e.ctrlKey&&!["paste","cut"].includes(e.type))return!0;r(this,A)[A](arguments),r(this,m)[m].lengthLimitVisible=!0;let s,l=r(this,c)[c].value,n=this.getHTMLSupportedAttr(r(this,c)[c],"selectionStart")||0,a=!(null==n),o=this.getHTMLSupportedAttr(r(this,c)[c],"selectionEnd")||0,d=parseInt(r(this,m)[m].combCells)||0,u=t;if(d>0&&(u=t.substr(0,d-l.length+o-n)),!a)return!0;s=l.substr(0,n)+u+l.substr(o);let h=r(this,w)[w](s);return null==r(this,b)[b]||h.match(r(this,b)[b])||h.match(r(this,f)[f])?!["keydown","cut"].includes(e.type)&&d&&(l.length>=d||s.length>d)&&n===o?(e.preventDefault(),!1):(r(this,m)[m].curValue=l,r(this,y)[y]=l,void(r(this,m)[m].pos=n)):(e.preventDefault(),!1)}function R(e){if(e){let t=e.charCode||e.which||e.keyCode||0;if(8===t||46===t)r(this,V)[V](e,"",t);else if(32===t)return e.preventDefault(),!1}}function Q(e){e=r(this,w)[w](e);let t=String.fromCharCode(r(this,m)[m].zero.charCodeAt(0)+9);return e>="0"&&e<="9"||e>=r(this,m)[m].zero&&e<=t||e===r(this,m)[m].decimal||e===r(this,m)[m].minus}function z(e){if(e){let t=e.charCode||e.which||e.keyCode||0,i=String.fromCharCode(t);if(this.isNonPrintableKey(e.key))return!0;if(r(this,C)[C](i))r(this,V)[V](e,i,t);else if(!e.ctrlKey)return e.preventDefault(),!1}}function J(e){if(e){let t;if(window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):(e.originalEvent||e).clipboardData&&(e.originalEvent||e).clipboardData.getData&&(t=(e.originalEvent||e).clipboardData.getData("text/plain")),t)if(t.split("").every(function(e){return r(this,C)[C](e)},this))t=r(this,w)[w](t),r(this,V)[V](e,t,0);else if(!e.ctrlKey)return e.preventDefault(),!1}}function K(e){e&&r(this,V)[V](e,"",0)}function U(e){let t=r(this,m)[m].zero.charCodeAt(0);return e.map(function(e){return"."===e?r(this,m)[m].decimal:"-"===e?r(this,m)[m].minus:String.fromCharCode(parseInt(e)+t)},this).join("")}function G(e){e=r(this,w)[w](e);let t=r(this,m)[m].zero.charCodeAt(0);return e.map(function(e){return e===r(this,m)[m].decimal?".":e===r(this,m)[m].minus?"-":(e.charCodeAt(0)-t).toString()},this).join("")}function X(){return null===r(this,h)[h].value&&""===r(this,c)[c].value||r(this,h)[h].value===r(this,c)[c].value}class Y extends l{constructor(...e){super(...e),this.widgetObject=void 0}getClass(){return Y.IS}getWidget(){return this.element.querySelector(Y.selectors.widget)}getDescription(){return this.element.querySelector(Y.selectors.description)}getLabel(){return this.element.querySelector(Y.selectors.label)}getErrorDiv(){return this.element.querySelector(Y.selectors.errorDiv)}getTooltipDiv(){return this.element.querySelector(Y.selectors.tooltipDiv)}getQuestionMarkDiv(){return this.element.querySelector(Y.selectors.qm)}_updateValue(e){null==this.widgetObject&&(this._model._jsonModel.editFormat||this._model._jsonModel.displayFormat)&&(this.widgetObject=new P(this.getWidget(),this._model)),this.widgetObject?this.widgetObject.setValue(e):super._updateValue(e)}addListener(){var e,t,i,r,s;null!=(e=this._model)&&null!=(t=e._jsonModel)&&t.editFormat||null!=(i=this._model)&&null!=(r=i._jsonModel)&&r.displayFormat?null==this.widgetObject&&(this.widgetObject=new P(this.getWidget(),this._model)):null==(s=this.getWidget())||s.addEventListener("blur",e=>{this._model.value=e.target.value})}getbemBlock(){return Y.bemBlock}getIS(){return Y.IS}createInputHTML(){let e=document.createElement("input");return e.className="cmp-adaptiveform-numberinput__widget",e.title=this.isTooltipVisible()?this.getTooltipValue():"",e.type="number",e.name=this.getName(),e.value=this.getDefault(),e.placeholder=this.getPlaceHolder(),e.required=this.isRequired(),e.setAttribute("aria-label",this.isLabelVisible()?this.getLabelValue():""),this.setDisabledAttribute(e),this.setReadonlyAttribute(e),this.setNumberConstraints(e),e}}Y.NS="cmp",Y.IS="adaptiveFormNumberInput",Y.bemBlock="cmp-adaptiveform-numberinput",Y.selectors={self:"[data-"+Y.NS+'-is="'+Y.IS+'"]',widget:`.${Y.bemBlock}__widget`,label:`.${Y.bemBlock}__label`,description:`.${Y.bemBlock}__longdescription`,errorDiv:`.${Y.bemBlock}__errormessage`,qm:`.${Y.bemBlock}__questionmark`,tooltipDiv:`.${Y.bemBlock}__shortdescription`};class Z extends l{constructor(e,t){super(e,t),this.qm=this.element.querySelector(Z.selectors.qm)}getWidget(){return this.element.querySelector(Z.selectors.widget)}getWidgets(){return this.element.querySelectorAll(Z.selectors.widget)}getDescription(){return this.element.querySelector(Z.selectors.description)}getLabel(){return this.element.querySelector(Z.selectors.label)}getQuestionMarkDiv(){return this.element.querySelector(Z.selectors.qm)}getTooltipDiv(){return this.element.querySelector(Z.selectors.tooltipDiv)}getErrorDiv(){return this.element.querySelector(Z.selectors.errorDiv)}_updateValue(e){null!=e&&this.getWidgets().forEach(t=>{null!=t.value&&e.toString()==t.value.toString()?(t.checked=!0,t.setAttribute("checked","checked"),t.setAttribute("aria-checked",!0+"")):(t.checked=!1,t.removeAttribute("checked"),t.setAttribute("aria-checked",!1+""))},this)}_updateEnabled(e){this.toggle(e,"aria-disabled",!0),this.element.setAttribute("data-cmp-enabled",e+"");let t=this.getWidgets();null==t||t.forEach(t=>{!1===e?(t.setAttribute("disabled",!0+""),t.setAttribute("aria-disabled",!0+"")):(t.removeAttribute("disabled"),t.removeAttribute("aria-disabled"))})}addListener(){this.getWidgets().forEach(e=>{e.addEventListener("change",e=>{this._model.value=e.target.value})})}getbemBlock(){return Z.bemBlock}getIS(){return Z.IS}createInputHTML(){var e;let t=[];return null==(e=this.getEnum())||e.forEach((e,i)=>{var r;t.push(this.createRadioButton(this,e,null==(r=this.getEnumNames())?void 0:r[i],i))}),t}createRadioButton(e,t,i,r){let s=document.createElement("div");s.className="cmp-adaptiveform-radiobutton__option "+e.getLayoutProperties().orientation;let l=document.createElement("label");l.className="cmp-adaptiveform-radiobutton__option__label",l.title=e.getTooltipValue(),l.setAttribute("aria-label",i),l.setAttribute("aria-describedby","_desc");let n=document.createElement("input");n.type="radio",n.name=e.getName(),n.className="cmp-adaptiveform-radiobutton__option__widget",n.id=e.getId()+"_"+r+"__widget",n.value=t,n.checked=t==this.getDefault(),n.setAttribute("aria-describedby","_desc"),this.setDisabledAttribute(n);let a=document.createElement("span");return a.textContent=i,l.appendChild(n),l.appendChild(a),s.appendChild(l),s}}Z.NS="cmp",Z.IS="adaptiveFormRadioButton",Z.bemBlock="cmp-adaptiveform-radiobutton",Z.selectors={self:"[data-"+Z.NS+'-is="'+Z.IS+'"]',widget:`.${Z.bemBlock}__option__widget`,label:`.${Z.bemBlock}__label`,description:`.${Z.bemBlock}__longdescription`,qm:`.${Z.bemBlock}__questionmark`,errorDiv:`.${Z.bemBlock}__errormessage`,tooltipDiv:`.${Z.bemBlock}__shortdescription`};class ee extends l{getWidget(){return null}getDescription(){return null}getLabel(){return null}getErrorDiv(){return null}getTooltipDiv(){return null}getQuestionMarkDiv(){return null}getClass(){return ee.IS}setFocus(){this.setActive()}getbemBlock(){return ee.bemBlock}getIS(){return ee.IS}createView(){let e=document.createElement("div");e.id=this.getId(),e.className="cmp-adaptiveform-text",e.dataset.cmpVisible=this.isVisible.toString(),e.dataset.cmpAdaptiveformcontainerPath=this.getFormContainerPath(),e.dataset.cmIs=this.getIS();let t=document.createElement("div");return t.className="cmp-adaptiveform-text__widget",t.tabIndex=0,t.textContent=this.state.value,e}}ee.NS="cmp",ee.IS="adaptiveFormText",ee.bemBlock="cmp-adaptiveform-text",ee.selectors={self:"[data-"+ee.NS+'-is="'+ee.IS+'"]'};class te extends l{getWidget(){return this.element.querySelector(te.selectors.widget)}getDescription(){return this.element.querySelector(te.selectors.description)}getLabel(){return this.element.querySelector(te.selectors.label)}getErrorDiv(){return this.element.querySelector(te.selectors.errorDiv)}getTooltipDiv(){return this.element.querySelector(te.selectors.tooltipDiv)}getQuestionMarkDiv(){return this.element.querySelector(te.selectors.qm)}addListener(){var e,t;null==(e=this.getWidget())||e.addEventListener("blur",e=>{this._model.value=e.target.value,this.setInactive()}),null==(t=this.getWidget())||t.addEventListener("focus",e=>{this.setActive()})}getbemBlock(){return te.bemBlock}getIS(){return te.IS}createInputHTML(){var e,t;let i=document.createElement("input");return i.className="cmp-adaptiveform-sliderInput__widget",i.title=this.isTooltipVisible()?this.getTooltipValue():"",i.type="range",i.name=this.getName(),i.value=this.getDefault(),i.step=this.state.step,i.placeholder=this.getPlaceHolder(),i.required=this.isRequired(),i.min=null==(e=this.getMinLength())?void 0:e.toString(),i.max=null==(t=this.getMaxLength())?void 0:t.toString(),i.setAttribute("aria-label",this.isLabelVisible()?this.getLabelValue():""),this.setDisabledAttribute(i),this.setReadonlyAttribute(i),this.setNumberConstraints(i),i}}te.NS="cmp",te.IS="adaptiveFormSliderInput",te.bemBlock="cmp-adaptiveform-sliderinput",te.selectors={self:"[data-"+te.NS+'-is="'+te.IS+'"]',widget:`.${te.bemBlock}__widget`,label:`.${te.bemBlock}__label`,description:`.${te.bemBlock}__longdescription`,qm:`.${te.bemBlock}__questionmark`,errorDiv:`.${te.bemBlock}__errormessage`,tooltipDiv:`.${te.bemBlock}__shortdescription`};class ie extends n{createInputHTML(){let e=document.createElement("input");return e.className="cmp-adaptiveform-textinput__widget",e.title=this.isTooltipVisible()?this.getTooltipValue():"",e.type="email",e.name=this.getName(),e.value=this.getDefault(),e.placeholder=this.getPlaceHolder(),e.required=this.isRequired(),e.setAttribute("aria-label",this.isLabelVisible()?this.getLabelValue():""),this.setDisabledAttribute(e),this.setReadonlyAttribute(e),this.setStringContraints(e),e}}class re extends l{constructor(e,t){super(e,t),this.widgetLabel=void 0,this.qm=this.element.querySelector(re.selectors.qm),this.widgetLabel=this.element.querySelector(re.selectors.widgetLabel)}getWidget(){return this.element.querySelector(re.selectors.widget)}getWidgets(){return this.element.querySelectorAll(re.selectors.widget)}getDescription(){return this.element.querySelector(re.selectors.description)}getLabel(){return this.element.querySelector(re.selectors.label)}getErrorDiv(){return this.element.querySelector(re.selectors.errorDiv)}getQuestionMarkDiv(){return this.element.querySelector(re.selectors.qm)}getTooltipDiv(){return this.element.querySelector(re.selectors.tooltipDiv)}_updateModelValue(){let e=[],t=this.getWidgets();null==t||t.forEach(t=>{t.checked&&e.push(t.value)},this),this._model.value=e}_updateEnabled(e){this.toggle(e,"aria-disabled",!0),this.element.setAttribute("data-cmp-enabled",e+"");let t=this.getWidgets();null==t||t.forEach(t=>{!1===e?(t.setAttribute("disabled",!0+""),t.setAttribute("aria-disabled",!0+"")):(t.removeAttribute("disabled"),t.removeAttribute("aria-disabled"))})}addListener(){this.getWidgets().forEach(e=>{e.addEventListener("change",e=>{this._updateModelValue()})})}getbemBlock(){return re.bemBlock}getIS(){return re.IS}createInputHTML(){var e;let t=document.createElement("div");return t.className="cmp-adaptiveform-checkboxgroup__widget",null==(e=this.getEnum())||e.forEach((e,i,r)=>{var s;t.appendChild(this.createCheckboxHTML(this,e,(null==(s=this.getEnumNames())?void 0:s[i])||e,i,null==r?void 0:r.length))}),t}createCheckboxHTML(e,t,i,r,s){let l=document.createElement("div");l.className="cmp-adaptiveform-checkboxgroup-item "+e.getName()+" "+e.getLayoutProperties().orientation;let n=document.createElement("label");n.className="cmp-adaptiveform-checkbox__label",n.title=e.getTooltipValue(),n.htmlFor=e.id+"_"+r+"__widget",n.setAttribute("aria-label",i);let a=document.createElement("input");a.className="cmp-adaptiveform-checkbox__widget",a.type="checkbox",a.id=n.htmlFor,a.value=t.toString(),a.name=s>1?e.getName():e.getLabelValue(),a.checked=t==e.getDefault(),a.setAttribute("aria-describedby","_desc"),this.setDisabledAttribute(a);let o=document.createElement("span");return o.textContent=this.getEnum().length>1?i:e.getLabelValue(),n.appendChild(a),n.appendChild(o),l.appendChild(n),l}createLabel(){var e;let t=document.createElement("label");return t.id=this.getId()+"-label",t.htmlFor=this.getId(),t.className=this.getbemBlock()+"__label",t.textContent=this.getLabelValue(),t.hidden=this.isLabelVisible()&&1==(null==(e=this.getEnum())?void 0:e.length),t}}re.NS="cmp",re.IS="adaptiveFormCheckBoxGroup",re.bemBlock="cmp-adaptiveform-checkboxgroup",re.checkboxBemBlock="cmp-adaptiveform-checkbox",re.selectors={self:"[data-"+re.NS+'-is="'+re.IS+'"]',widgets:`.${re.bemBlock}__widgets`,widget:`.${re.checkboxBemBlock}__widget`,widgetLabel:`.${re.checkboxBemBlock}__label`,label:`.${re.bemBlock}__label`,description:`.${re.bemBlock}__longdescription`,qm:`.${re.bemBlock}__questionmark`,errorDiv:`.${re.bemBlock}__errormessage`,tooltipDiv:`.${re.bemBlock}__shortdescription`};var se=/*#__PURE__*/i("formJson"),le=/*#__PURE__*/i("element");class ne{constructor(e){this._model=void 0,this._path=void 0,this._deferredParents=void 0,Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),this.renderChildrens=(e,t)=>{console.time("Rendering childrens");let i=null==t?void 0:t.items;i&&i.length>0&&i.forEach((t,i)=>{e.append(this.getRender(t,i))}),console.timeEnd("Rendering childrens")},this.getRender=(e,t)=>{const i=document.createElement("div");try{let r,s;this.isFull()?s=this.getModel(e.id):(s=e,s.id=t);let l={element:i,id:e.id};switch(null==e?void 0:e.fieldType){case"checkbox":r=new re(l,s);break;case"email":r=new ie(l,s);break;case"slider":r=new te(l,s);break;case"plain-text":r=new ee(l,s);break;case"radio":r=new Z(l,s);break;case"number":r=new Y(l,s);break;case"button":r=new u(l,s);break;case"select":r=new d(l,s);break;case"text-area":r=new a(l,s);break;default:r=new n(l,s)}r&&r.render()}catch(e){console.error("Unexpected error ",e)}return i},r(this,se)[se]=null==e?void 0:e._formJson,this._path=e._path,this._deferredParents={}}getModel(e){var t;return e?null==(t=this._model)?void 0:t.getElement(e):this._model}getPath(){return this._path}isFull(){var e,t;return null==(e=r(this,se)[se])||null==(t=e.metadata)?void 0:t.rulesUsed}render(e){const t=document.createElement("form");let i;t.className="cmp-adaptiveform-container cmp-container",r(this,le)[le]=t,this.isFull()?import("./afcore.js").then(s=>{var l;return this._model=s.createFormInstance(r(this,se)[se],null),i=null==(l=this._model)?void 0:l.getState(),this.renderChildrens(t,i),e.replaceWith(t),t}):(i=r(this,se)[se],this.renderChildrens(t,i),e.replaceWith(t))}}var ae=/*#__PURE__*/i("getFormDef"),oe=/*#__PURE__*/i("handlePanel"),de=/*#__PURE__*/i("handleProperty"),ue=/*#__PURE__*/i("handleCheckbox"),ce=/*#__PURE__*/i("setProperty"),he=/*#__PURE__*/i("handleMultiValues"),me=/*#__PURE__*/i("handleHierarchy"),pe=/*#__PURE__*/i("haveRule"),ge=/*#__PURE__*/i("haveConstraintMsg"),be=/*#__PURE__*/i("isPanel"),ve=/*#__PURE__*/i("isEndingPanel"),fe=/*#__PURE__*/i("cleanUpPanel");class _e{constructor(){Object.defineProperty(this,fe,{value:Me}),Object.defineProperty(this,ve,{value:qe}),Object.defineProperty(this,be,{value:Ce}),Object.defineProperty(this,ge,{value:Ae}),Object.defineProperty(this,pe,{value:Ve}),Object.defineProperty(this,me,{value:Le}),Object.defineProperty(this,he,{value:Ee}),Object.defineProperty(this,ce,{value:De}),Object.defineProperty(this,ue,{value:Se}),Object.defineProperty(this,de,{value:ke}),Object.defineProperty(this,oe,{value:we}),Object.defineProperty(this,ae,{value:ye})}async _getForm(e){if(!e)throw new Error("formPath is required");const t=await fetch(e);return await t.json()}async getFormModel(e){if(e){console.time("Get Excel JSON");let i=await this._getForm(e);if(console.timeEnd("Get Excel JSON"),!i||!i.data)throw new Error("Unable to retrieve the form details from "+e);const s=r(this,ae)[ae](e);var t=[];t.push(s.items);let l=s;return i.data.forEach((e,i)=>{if(r(this,be)[be](e)){e.items={};let i=JSON.parse(JSON.stringify(e));r(this,oe)[oe](i),l.items.push(i),t.push(l),l=i}else r(this,ve)[ve](e)?(l=t.pop(),l||(l=s)):l.items.push(r(this,de)[de](s,e,i))}),{formDef:s,excelData:i}}}}function ye(e){return{adaptiveform:"0.10.0",metadata:{grammar:"json-formula-1.0.0",version:"1.0.0"},items:[],action:e.split(".json")[0]}}function we(e){if(r(this,fe)[fe](e),r(this,pe)[pe](e)){let t=r(this,me)[me](e,"Rules.");t&&0!=Object.keys(t).length&&(e.rules=t)}let t=r(this,me)[me](e,"Events.");t&&0!=Object.keys(t).length&&(e.events=t)}function ke(e,t,i){let s=Object.fromEntries(Object.entries(t).filter(([e,t])=>null!=t&&""!=t)),l=_e.fieldMapping.has(s.Type)?_e.fieldMapping.get(s.Type):s.Type,n={name:s.Field,placeholder:s.Placeholder,type:"string",fieldType:l,value:s.Value,label:{value:s.Label},required:!!s.Mandatory};if(r(this,ce)[ce](s,"Maximum",n,"maximum"),r(this,ce)[ce](s,"Minimum",n,"minimum"),r(this,ce)[ce](s,"MaxLength",n,"maxLength"),r(this,ce)[ce](s,"MinLength",n,"minLength"),r(this,ce)[ce](s,"Step",n,"step"),r(this,pe)[pe](s)){let t=r(this,me)[me](s,"Rules.");t&&0!=Object.keys(t).length&&(n.rules=t,e.metadata.rulesUsed=!0)}if(r(this,ge)[ge](s)){let e=r(this,me)[me](s,"constraintMessages.");e&&0!=Object.keys(e).length&&(n.constraintMessages=e)}let a=r(this,me)[me](s,"Events.");a&&0!=Object.keys(a).length&&(n.events=a);let o=r(this,he)[he](s,"Options");return o&&(n.enumNames=n.enum=o),r(this,ue)[ue](n),n}function Se(e){"checkbox"!=(null==e?void 0:e.fieldType)||e.enum&&0!=e.enum.length||(e.enum=["on"])}function De(e,t,i,r){e&&e[t]&&(i[r]=e[t])}function Ee(e,t){let i;return e&&e[t]&&(i=e[t].split(",").map(e=>e.trim())),i}function Le(e,t){let i={};return Object.keys(e).forEach(r=>{if(~r.indexOf(t)){let t=r.split(".")[1];e[r]&&(i[t]=e[r]),delete e[r]}}),i}function Ve(e){return Object.keys(e).some(function(e){return~e.indexOf("Rules.")})}function Ae(e){return Object.keys(e).some(function(e){return~e.indexOf("constraintMessages.")})}function Ce(e){return e&&"object"==e.type}function qe(e){return e&&"page-break"==e.viewType}function Me(e){delete e.type}async function xe(e){const t=null==e?void 0:e.querySelector('a[href$=".json"]');t&&null!=t&&t.href&&await(async e=>{if(e&&null!=e&&e.href){let t=e.href;console.log("Loading & Converting excel form to Crispr Form"),console.time("Json Transformation (including Get)");const i=new _e,r=await i.getFormModel(t);console.timeEnd("Json Transformation (including Get)"),console.log(r),console.log("Creating Form Container"),console.time("Form Model Instance Creation");let s=new ne({_formJson:null==r?void 0:r.formDef,_path:t});console.timeEnd("Form Model Instance Creation"),window.guideContainer=s,console.time("Form Rendition"),s.render(e),console.timeEnd("Form Rendition")}})(t)}_e.fieldMapping=new Map([["text-input","text"],["number-input","number"],["date-input","datetime-local"],["file-input","file"],["drop-down","select"],["radio-group",""],["checkbox-group",""],["plain-text","plain-text"],["checkbox","checkbox"],["multiline-input","text-area"],["panel","panel"],["submit","button"]]);export{e as _,xe as d};
